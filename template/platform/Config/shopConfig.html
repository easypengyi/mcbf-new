{extend name="platform/new_base" /}
{block name="resources"/}
{/block}
{block name="main"}
<!-- page -->
<ul class="nav nav-tabs v-nav-tabs" role="tablist">
    <li role="presentation" class="active"><a href="#basic" aria-controls="basic"  data-type="basic" role="tab" data-toggle="tab" class="flex-auto-center">基本设置</a></li>
    <li role="presentation"><a href="#tradeset" aria-controls="tradeset" data-type="tradeset" role="tab" data-toggle="tab" class="flex-auto-center">交易设置</a></li>
    <li role="presentation"><a href="#withdrawalset" aria-controls="withdrawalset" data-type="withdrawalset" role="tab" data-toggle="tab" class="flex-auto-center">提现设置</a></li>
    <li role="presentation"><a href="#validate" aria-controls="validate" data-type="validate" role="tab" data-toggle="tab" class="flex-auto-center">验证码设置</a></li>
    <li role="presentation"><a href="#message" aria-controls="message" data-type="message" role="tab" data-toggle="tab" class="flex-auto-center">短信通知</a></li>
    <li role="presentation"><a href="#payment" aria-controls="payment" data-type="payment" role="tab" data-toggle="tab" class="flex-auto-center payment">支付方式</a></li>
    <li role="presentation"><a href="#returnsetting" aria-controls="returnsetting" data-type="returnsetting" role="tab" data-toggle="tab" class="flex-auto-center">商家地址</a></li>
    <li role="presentation"><a href="#storageconfig" aria-controls="storageconfig" data-type="storageconfig" role="tab" data-toggle="tab" class="flex-auto-center">素材存储</a></li>
    <li role="presentation"><a href="#redis" aria-controls="redis" data-type="redis" role="tab" data-toggle="tab" class="flex-auto-center">REDIS配置</a></li>
    <li role="presentation"><a href="#copystyle" aria-controls="copystyle" data-type="copystyle" role="tab" data-toggle="tab" class="flex-auto-center">文案样式</a></li>
    <li role="presentation"><a href="#wechat" aria-controls="wechat" data-type="wechat" role="tab" data-toggle="tab" class="flex-auto-center">微信开放平台</a></li>
</ul>
<div class="tab-content pt-15">
    <div role="tabpanel" class="tab-pane fade in active" id="basic" >
        <form class="form-horizontal form-validate1 widthFixedForm">
            <div class="screen-title2" data-id="t2">
                <span class="text">移动商城</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">移动商城</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="waptype">
                        <label for="waptype" class=""></label>
                    </div>
                    <p class="help-block">关闭后微信端、WAP端商城无法使用</p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">商城Logo</label>
                <div class="col-md-5">
                    <div class="picture-list" id="wap_logo">

                    </div>
                    <p class="help-block">建议100 * 100，支持JPG\GIF\PNG格式</p>
                </div>
            </div>
            <div class="wap_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label">注册页广告图</label>
                    <div class="col-md-5">
                        <div class="picture-list" id="wap_register_adv">

                        </div>
                        <p class="help-block">建议700 * 394，支持JPG\GIF\PNG格式</p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">注册页广告图链接</label>
                    <div class="col-md-5">
                        <div class="input-group item">
                            <input type="text" class="form-control item" id="wap_register_jump" value="">
                            <span class="input-group-btn"><a href="javascript:void(0);" class="btn btn-default link_set">选择链接</a></span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">登录页广告图</label>
                    <div class="col-md-5">
                        <div class="picture-list" id="wap_login_adv">

                        </div>
                        <p class="help-block">建议700 * 394，支持JPG\GIF\PNG格式</p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">登录页广告图链接</label>
                    <div class="col-md-5">
                        <div class="input-group item">
                            <input type="text" class="form-control" id="wap_login_jump" value="">
                            <span class="input-group-btn"><a href="javascript:void(0);" class="btn btn-default link_set">选择链接</a></span>
                        </div>
                    </div>
                </div>
                <div class="form-group close_rule" style="display: none">
                    <label class="col-md-2 control-label">商城关闭原因</label>
                    <div class="col-md-5">
                        <textarea class='form-control' rows="4" id="close_reason"></textarea>
                    </div>
                </div>
            </div>
            <div class="screen-title2" data-id="t2">
                <span class="text">商城全局</span>
                <span class="text1">该栏目数据将全渠道同步。</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>商城名称</label>
                <div class="col-md-5">
                    <input type="text" class="form-control" id="mall_name" value="" required autocomplete="off">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">会员注册协议</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="reg_rule">
                        <label for="reg_rule" class=""></label>
                    </div>
                </div>
            </div>
            <div class="form-group reg_rule" style="display: none">
                <label class="col-md-2 control-label"></label>
                <input type="hidden" id="reg_id" value="">
                <div class="col-md-5" id="reg_message">
                </div>
                <!--<p class="help-block">需前往<a class="text-primary" href="{:__URL('ADDONS_MAINquestionList')}" target="_blank">帮助中心</a>发布</p>-->
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">会员购买协议</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="pur_rule">
                        <label for="pur_rule" class=""></label>
                    </div>
                </div>
            </div>
            <div class="form-group pur_rule" style="display: none">
                <label class="col-md-2 control-label"></label>
                <input type="hidden" id="pur_id" value="{$website['pur_id']}">
                <div class="col-md-5" id="shop_message">
                </div>
                <!--<p class="help-block">需前往<a class="text-primary" href="{:__URL('ADDONS_MAINquestionList')}" target="_blank">帮助中心</a>发布</p>-->
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary basic_set" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="message" >
        <div class="mb-20">
            <button class="btn btn-primary messageConfig">短信平台配置</button>
            <button class="btn btn-primary ml-15 emailConfig">邮箱账号配置</button>
        </div>
        <table class="table v-table table-auto-center">
            <thead>
                <tr>
                    <th>模版名称</th>
                    <th>通知人类型</th>
                    <th>模版类型</th>
                    <th>短信模版</th>
                    <th>邮箱模版</th>
                </tr>
            </thead>
            <tbody id="list">

            </tbody>
        </table>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="payment" style="min-width:1614px;">
        <div class="payment-div hide" id="pay-wap">
            <div class="payment-top">
                <h3 class="top-title">网页端</h3>
                <p class="top-desc">在微信公众号、移动H5、PC端支付或提现时使用</p>
            </div>
            <div class="pay-list J-h5">
            </div>
            <div style="clear: both;"></div>
            <div></div>
            <div class="pay-bottom">
                <button class="btn btn-primary J-pay-setting" data-pay_type="1">设置支付方式</button>
            </div>
        </div>
        <div class="payment-div hide" id="pay-mp">
            <div class="payment-top">
                <h3 class="top-title">小程序端</h3>
                <p class="top-desc">在微信小程序支付或提现时使用</p>
            </div>
            <div class="pay-list J-mp">
            </div>
            <div style="clear: both;"></div>
            <div></div>
            <div class="pay-bottom">
                <button class="btn btn-primary J-pay-setting" data-pay_type="2">设置支付方式</button>
            </div>
        </div>
        <div class="payment-div hide" id="pay-app">
            <div class="payment-top">
                <h3 class="top-title">APP端</h3>
                <p class="top-desc">在APP商城支付或提现时使用</p>
            </div>
            <div class="pay-list J-app">
            </div>
            <div style="clear: both;"></div>
            <div></div>
            <div class="pay-bottom">
                <button class="btn btn-primary J-pay-setting" data-pay_type="3">设置支付方式</button>
            </div>
        </div>
        <div style="clear: both"></div>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="tradeset">
        <form class="form-horizontal form-validate4 pt-15 widthFixedForm">
            <div class="screen-title2" data-id="t2">
                <span class="text">配送方式</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>快递配送</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" name="has_express" id="has_express" class="has_express" value="1" checked>
                        <label for="has_express" class="has_express"></label>
                    </div>
                    <p class="help-block">关闭后商城前端不支持快递配送</p>
                </div>
            </div>
            {if $store}
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>门店自提</label>
                <div class="col-md-5">
                    <p class="form-control-static"><a href="{:__URL('ADDONS_MAINstoreSetting')}" class="text-primary" >点击前往</a>O2O门店应用配置</p>
                </div>
            </div>
            {/if}
            <div class="screen-title2" data-id="t2">
                <span class="text">订单处理</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>订单自动关闭时间</label>
                <div class="col-md-5">
                    <div class="input-group w-200">
                        <input type="number" class="form-control" id="order_buy_close_time" name="order_buy_close_time" value="" min="1" required>
                        <div class="input-group-addon">分</div>
                    </div>
                    <p class="help-block">订单超过设定时间自动关闭</p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>自动收货时间</label>
                <div class="col-md-5">
                    <div class="input-group w-200">
                        <input type="number" class="form-control" id="order_auto_delivery"  name="order_auto_delivery" min="0" value="" required>
                        <div class="input-group-addon">天</div>
                    </div>
                    <p class="help-block">订单超过设定时间自动收货</p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>订单完成时间</label>
                <div class="col-md-5">
                    <div class="input-group w-200">
                        <input type="number" class="form-control" id="order_delivery_complete_time"  name="order_delivery_complete_time" min="0" value="" required>
                        <div class="input-group-addon">天</div>
                    </div>
                    <p class="help-block">收货后多长时间完成订单，订单完成后不能进行售后</p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>自动评价</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="is_translation" name="is_translation">
                        <label for="is_translation" class=""></label>
                    </div>
                </div>
            </div>
            <div class="translation_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>自动评价时间</label>
                    <div class="col-md-5">
                        <div class="input-group w-200">
                            <input type="number" class="form-control number-form-control" name="translation_time" id="translation_time" value="" min="0" >
                            <div class="input-group-addon">天</div>
                        </div>
                        <p class="help-block">订单完成后多长时间自动好评</p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">评价内容</label>
                    <div class="col-md-5">
                        <div class="input-group w-200">
                            <input type="text" class="form-control number-form-control" name="translation_text" id="translation_text" value="" >
                            <div class="input-group-addon"></div>
                        </div>
                        <p class="help-block">自动评价的内容，空则不显示评价内容</p>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">好评送积分</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="evaluate_give_point" name="evaluate_give_point">
                        <label for="evaluate_give_point" class=""></label>
                    </div>
                </div>
            </div>
            <div class="form-group point_num hide">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>赠送积分</label>
                <div class="col-md-5">
                    <div class="input-group w-200">
                        <input type="number" class="form-control number-form-control" name="point_num" id="point_num" value="" min="0" >
                        <div class="input-group-addon">积分</div>
                    </div>
                    <p class="help-block">开启后，商品好评时将赠送积分</p>
                </div>
            </div>
            <!--支付密码-->
            <div class="screen-title2" data-id="t2">
                <span class="text">支付密码</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>支付密码</label>
                <div class="col-md-7">
                    <div class="switch-inline">
                        <input type="checkbox" id="close_pay_password" name="close_pay_password" checked>
                        <label for="close_pay_password" class=""></label>
                    </div>
                    <p class="help-block">关闭后商城前端则无需设置支付密码，交易时也无需使用支付密码验证。如涉及区块链钱包业务支付密码必须打开。</p>
                </div>
            </div>
            <div class="form-group hide" id="pay_password_length">
                <label class="col-md-2 control-label">密码类型</label>
                <div class="col-md-8" >
                    <label class="radio-inline">
                        <input type="radio" name="pay_password_length" class="pay_password_length" value="1"> 9位数密码
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="pay_password_length" class="pay_password_length" value="2"  > 6位数密码
                    </label>
                    <p class="help-block">系统正式使用过程中请勿随意切换，否则将会导致已设置的支付密码不能验证通过。</p>
                </div>
            </div>

            <!--返佣/抵扣-->
            <div class="screen-title2" data-id="t2">
                <span class="text">返佣/抵扣</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>积分汇率</label>
                <div class="col-md-7">
                    <div class="input-group w-200">
                        <input type="number" class="form-control number-form-control" name="convert_rate" id="convert_rate" value="" min="1" required>
                        <div class="input-group-addon">积分/元</div>
                    </div>
                    <p class="help-block">商城积分需要兑换人民币业务时则按该汇率计算，积分只会以整数扣除，如遇到除不尽的小数则积分向下取整方式扣除</p>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">购物返积分</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="point" name="point">
                        <label for="point" class=""></label>
                    </div>
                </div>
            </div>
            <div class="point_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>积分计算方式</label>
                    <div class="col-md-5">
                        <select class="form-control w-200" id="integral_calculation" name="integral_calculation" min="0" required title=" ">
                            <option value="-1" selected="selected">请选择</option>
                            <option value="1">订单总价</option>
                            <option value="2">商品总价</option>
                            <option value="3">实际支付金额</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>购物返积分比例</label>
                    <div class="col-md-5">
                        <div class="input-group w-200">
                            <input type="number" class="form-control number-form-control" id="point_invoice_tax" name="point_invoice_tax" value="" min="0">
                            <div class="input-group-addon">%</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>购物返积分节点</label>
                    <div class="col-md-5">
                        <select class="form-control w-200" id="shopping_back_points" name="shopping_back_points" min="0" required title=" ">
                            <option value="-1" selected="selected">请选择</option>
                            <option value="1">订单已完成</option>
                            <option value="2">订单已收货</option>
                            <option value="3">订单支付完成</option>
                        </select>
                        <p class="help-block mb-0">建议设置为订单完成，否则订单产生售后有可能导致积分不足扣除</p>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">积分抵扣</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="point_deduction" name="point_deduction">
                        <label for="point_deduction" class=""></label>
                    </div>
                </div>
            </div>
            <div class="point_deduction_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>抵扣计算方式</label>
                    <div class="col-md-5">
                        <select class="form-control w-200" id="point_deduction_calculation" name="point_deduction_calculation" min="0" required title=" ">
                            <option  value="-1" selected="selected">请选择</option>
                            <option  value="1">订单总价</option>
                            <option  value="2">商品总价</option>
                            <option  value="3">商品实付金额</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>积分最大抵扣</label>
                    <div class="col-md-7">
                        <div class="input-group w-200">
                            <input type="number" class="form-control number-form-control" name="point_deduction_max" id="point_deduction_max" value="" min="0" max="100">
                            <div class="input-group-addon">%</div>
                        </div>
                        <p class="help-block">下单时积分最多抵扣多少，设置后所有商品均按该比例抵扣，0则不设置抵扣，可前往商品单独设置抵扣比例，设置抵扣优先级 “商品 > 商城配置”</p>
                    </div>
                </div>
            </div>
            <div class="screen-title2" data-id="t2">
                <span class="text">转账/兑换</span>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">余额转账</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="balance_transfer" name="balance_transfer">
                        <label for="balance_transfer" class=""></label>
                    </div>
                    <p class="help-block">开启后支持会员与会员之间的余额转账</p>
                </div>
            </div>
            <div class="balance_transfer_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label">转账手续费</label>
                    <div class="col-md-5">
                        <div class="switch-inline">
                            <input type="checkbox" id="balance_transfer_charge" name="balance_transfer_charge">
                            <label for="balance_transfer_charge" class=""></label>
                        </div>
                        <p class="help-block">开启后转账则需要收取手续费</p>
                    </div>
                </div>

                <div class="balance_transfer_charge_rule" style="display: none">
                    <div class="form-group">
                        <label class="col-md-2 control-label">手续费类型</label>
                        <div class="col-md-8" >
                            <label class="radio-inline">
                                <input type="radio" name="charge_type" class="charge_type" checked  value="1"> 比例收取
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="charge_type" class="charge_type" value="2"  > 固定收取
                            </label>
                        </div>
                    </div>
                    <div class="a" id="charge_input">
                        <div class="form-group">
                            <label class="col-md-2 control-label"><span class="text-bright">*</span>手续费</label>
                            <div class="col-md-5">
                                <div class="input-group w-200">
                                    <input type="number" class="form-control number-form-control" name="charge_pares" id="charge_pares" value="" min="0" >
                                    <div class="input-group-addon">%</div>
                                </div>
                                <p class="help-block">转账时收取的手续费</p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">最低手续费</label>
                            <div class="col-md-5">
                                <div class="input-group w-200">
                                    <input type="number" class="form-control number-form-control" name="charge_pares_min" id="charge_pares_min" value="" min="0" >
                                    <div class="input-group-addon">元</div>
                                </div>
                                <p class="help-block">当计算手续费少于最低手续费时将按最低手续费收取</p>
                            </div>
                        </div>
                    </div>
                    <div class="a hide" id="charge_input1">
                        <div class="form-group">
                            <label class="col-md-2 control-label"><span class="text-bright">*</span>手续费</label>
                            <div class="col-md-5">
                                <div class="input-group w-200">
                                    <input type="number" class="form-control number-form-control" name="charge_pares2" id="charge_pares2" value="" min="0" >
                                    <div class="input-group-addon">元</div>
                                </div>
                                <p class="help-block">转账时收取的手续费</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">余额积分转账</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="point_balance_transfer" name="balance_transfer">
                        <label for="point_balance_transfer" class=""></label>
                    </div>
                    <p class="help-block">开启后支持余额与积分之间的互换</p>
                </div>
            </div>
            <div class="point_balance_transfer_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label">转账手续费</label>
                    <div class="col-md-5">
                        <div class="switch-inline">
                            <input type="checkbox" id="point_balance_transfer_charge" name="point_balance_transfer_charge">
                            <label for="point_balance_transfer_charge" class=""></label>
                        </div>
                        <p class="help-block">开启后余额与积分兑换则需要收取手续费</p>
                    </div>
                </div>

                <div class="point_balance_transfer_charge_rule" style="display: none">
                    <div class="form-group">
                        <label class="col-md-2 control-label">手续费类型</label>
                        <div class="col-md-8" >
                            <label class="radio-inline">
                                <input type="radio" name="point_charge_type" class="point_charge_type" checked  value="1"> 比例收取
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="point_charge_type" class="point_charge_type" value="2"  > 固定收取
                            </label>
                        </div>
                    </div>
                    <div class="a" id="point_charge_input">
                        <div class="form-group">
                            <label class="col-md-2 control-label"><span class="text-bright">*</span>手续费</label>
                            <div class="col-md-5">
                                <div class="input-group w-200">
                                    <input type="number" class="form-control number-form-control" name="point_charge_pares" id="point_charge_pares" value="" min="0" >
                                    <div class="input-group-addon">%</div>
                                </div>
                                <p class="help-block">转账时收取的手续费</p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">最低手续费</label>
                            <div class="col-md-5">
                                <div class="input-group w-200">
                                    <input type="number" class="form-control number-form-control" name="point_charge_pares_min" id="point_charge_pares_min" value="" min="0" >
                                    <div class="input-group-addon">元</div>
                                </div>
                                <p class="help-block">当计算手续费少于最低手续费时将按最低手续费收取</p>
                            </div>
                        </div>
                    </div>
                    <div class="a hide" id="point_charge_input1">
                        <div class="form-group">
                            <label class="col-md-2 control-label"><span class="text-bright">*</span>手续费</label>
                            <div class="col-md-5">
                                <div class="input-group w-200">
                                    <input type="number" class="form-control number-form-control" name="point_charge_pares2" id="point_charge_pares2" value="" min="0" >
                                    <div class="input-group-addon">元</div>
                                </div>
                                <p class="help-block">转账时收取的手续费</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="col-md-2 control-label">美丽分转赠</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" name="beautiful_point_transfer" id="beautiful_point_transfer" class="beautiful_point_transfer" value="1" >
                        <label for="beautiful_point_transfer" class="beautiful_point_transfer"></label>
                    </div>
                    <p class="help-block">开启后支持美丽分转赠</p>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary add" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="returnsetting">
        <div id="returnsetting_list">
            <div class="mb-10">
                <a class="btn btn-primary" href="javascript:addressEdit(0);"><i class="icon icon-add1"></i> 添加模板</a>
            </div>
            <table class="table v-table table-auto-center">
                <thead>
                    <tr class="order-list-item">
                        <th>发货人</th>
                        <th>电话</th>
                        <th>发货地址</th>
                        <th>详细地址</th>
                        <th>是否默认</th>
                        <th class="col-md-2 pr-14 operationLeft">操作</th>
                    </tr>
                </thead>
                <tbody id="address_list">
                </tbody>
            </table>
            
			<nav aria-label="Page navigation" class="clearfix">
				<ul id="page" class="pagination pull-right"></ul>
			</nav>
        </div>
        <form class="form-horizontal form-validate5 pt-15 widthFixedForm hide" id="returnsetting_edit">
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>收货人</label>
                <div class="col-md-5">
                    <input type="text" class="form-control" name="return_consigner" id="return_consigner" value="" required >
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>联系方式</label>
                <div class="col-md-5">
                    <input type="text" name="return_mobile" class="form-control" id="return_mobile"  value="" required>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>收货地区</label>
                <div class="col-md-5">
                    <div class="area-form-group">
                        <select name="province" id="return_provinces"  class="form-control getProvince" min="0" required title=" ">
                            <option value="-1">请选择省...</option>
                        </select>
                        <select name="city" id="return_cities"  class="form-control getSelCity" min="0" required title=" ">
                            <option value="-1">请选择市...</option>
                        </select>
                        <select name="district" id="return_districts" class="form-control" min="0" required title=" ">
                            <option value="-1">请选择区...</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>详细地址</label>
                <div class="col-md-5">
                    <input type="text" class="form-control" name="return_address" id="return_address" value=""  required>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">邮政编码</label>
                <div class="col-md-5">
                    <input type="text" class="form-control" name="return_zip_code" id="return_zip_code" value="">
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">是否默认</label>
                <div class="col-md-5">
                    <label class="radio-inline">
                        <input type="radio" name="return_is_default" value="1" id="return_is_default">是
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="return_is_default" value="0" id="return_is_default2">否
                    </label>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary add" type="submit">保存</button>
                    <a href="javascript:void(0);" class="btn btn-default address_return_list">返回</a>
                </div>
            </div>
            <input type="hidden" id="return_id" name="return_id" value="0">
            <input type="hidden" id="pid" name="pid" value="">
            <input type="hidden" id="cid" name="cid" value="">
            <input type="hidden" id="aid" name="aid" value="">
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="withdrawalset">
        <form class="form-horizontal form-validate6 pt-15 widthFixedForm">
            <div class="form-group">
                <label class="col-md-2 control-label">是否开启</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="switch" name="enable">
                        <label for="switch" class=""></label>
                    </div>
                </div>
            </div>
            <div class="withdraw_rule" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>最低提现额度</label>
                    <div class="col-md-5">
                        <div class="input-group w-200">
                            <input type="number" class="form-control" id="cash_min" value="" required>
                            <div class="input-group-addon">元</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">提现自动审核</label>
                    <div class="col-md-5">
                        <div class="switch-inline">
                            <input type="checkbox"  name="is_examine" id="is_examine" >
                            <label for="is_examine" class=""></label>
                        </div>
                        <p class="help-block">开启后提现自动审核，关闭后需要人工操作审核</p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">提现自动打款</label>
                    <div class="col-md-5">
                        <div class="switch-inline">
                            <input type="checkbox"  name="make_money" id="make_money" >
                            <label for="make_money" class=""></label>
                        </div>
                        <p class="help-block">开启后提现自动打款，关闭后需要人工操作打款</p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>提现方式</label>
                    <div class="col-md-7">
                        <div>
                            <label class="checkbox-inline">
                                <input type="checkbox" name="withdrawals" class="withdrawals" value="3"> 支付宝
                            </label>
                            <label class="checkbox-inline">
                                <input type="checkbox" name="withdrawals" class="withdrawals" value="2"> 微信
                            </label>
                            <label class="checkbox-inline">
                                <input type="checkbox" name="withdrawals" class="withdrawals" value="4"> 银行卡(手动提现)
                            </label>
                            <label class="checkbox-inline">
                                <input type="checkbox" name="withdrawals" class="withdrawals" value="1"> 银行卡(自动提现)
                            </label>
                        </div>
                        <p class="help-block">银行卡（自动提现）提现金额可自动转账至银行账户（需配置通联支付），银行卡（手动提现）提现金额需要手动转账无需配置任何东西</p>
                    </div>
                </div>
                {if $shopStatus}
                <div class="form-group">
                    <label class="col-md-2 control-label">店铺提现手续费率</label>
                    <div class="col-md-5">
                        <div class="input-group w-200">
                            <input type="number" class="form-control" id="poundage" value=""  >
                            <div class="input-group-addon">%</div>
                        </div>
                    </div>
                </div>
                {/if}
                <div class="form-group">
                    <label class="col-md-2 control-label">会员提现手续费率</label>
                    <div class="col-md-5">
                        <div class="input-group w-200">
                            <input type="number" class="form-control" id="member_poundage" value="" >
                            <div class="input-group-addon">%</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label">免手续费提现区间</label>
                    <div class="col-md-5">
                        <div class="input-group w-400">
                            <input type="number" name="withdrawalsbegin" id="withdrawalsbegin" class="form-control number-form-control" step="0.1" min="0" value="">
                            <div class="input-group-addon"> ~ </div>
                            <input type="number" name="withdrawalsend" id="withdrawalsend" class="form-control number-form-control" step="0.1" min="0" value="">
                            <div class="input-group-addon">元</div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary add" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="copystyle">
        <form class="form-horizontal form-validate10 pt-15 widthFixedForm">
            <div class="form-group">
                <label class="col-md-2 control-label">余额</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="balance_style" value="" placeholder="余额">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">积分</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="point_style" value="" placeholder="积分">
                    </div>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary add" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="validate" >
        <form class="form-horizontal">
            <div class="form-group">
                <label class="col-md-2 control-label">商城验证码是否开启</label>
                <div class="col-md-5">
                    <div class="switch-inline">
                        <input type="checkbox" id="switch3" >
                        <label for="switch3" class=""></label>
                    </div>
                    <p class="help-block">登录注册失败三次才会触发验证码！</p>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <a class="btn btn-primary code_set">保存</a>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="storageconfig">
        <form class="form-horizontal form-validate7 pt-15">
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>存储方式</label>
                <div class="col-md-5">
                    <label class="radio-inline">
                        <input type="radio" name="storage_type"  value="1" checked> 本地
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="storage_type"  value="2" > 阿里云
                    </label>
                </div>
            </div>
            <div class="J-alioss" style="display: none">
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>accessKeyId</label>
                    <div class="col-md-5">
                        <input type="text" class="form-control" name="accessKeyId" id="accessKeyId" value=""  >
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>accessKeySecret</label>
                    <div class="col-md-5">
                        <input type="text" name="accessKeySecret" class="form-control"  id="accessKeySecret"  value="" >
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>Bucket</label>
                    <div class="col-md-5">
                        <select id="Bucket" name="Bucket" class="form-control m-b">

                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label"><span class="text-bright">*</span>Url</label>
                    <div class="col-md-5">
                        <input type="text" class="form-control" name="seller_zipcode" id="AliossUrl" value="" >
                    </div>
                </div>
            </div>

            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary" id="setAliossConfigAjax" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="redis">
        <form class="form-horizontal form-validate11 pt-15 widthFixedForm">
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>HOST</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="host" value="" placeholder="" required>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>PASSWORD</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="pass" value="" placeholder="" required>
                    </div>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary add" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
    <div role="tabpanel" class="tab-pane fade" id="wechat">
        <form class="form-horizontal form-validate12 pt-15 widthFixedForm">
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>AppID</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="open_appid" name="open_appid" value="" placeholder="" required>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>AppSecrect</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="open_secrect" name="open_secrect" value="" placeholder="" required>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>消息加解密Key</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="open_key" name="open_key" value="" placeholder="" required>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label"><span class="text-bright">*</span>消息验证Token</label>
                <div class="col-md-5">
                    <div class="input-group">
                        <input type="text" class="form-control" id="open_token" name="open_token" value="" placeholder="" required>
                    </div>
                </div>
            </div>
            <div class="form-group"></div>
            <div class="form-group">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-8">
                    <button class="btn btn-primary add" type="submit">保存</button>
                </div>
            </div>
        </form>
    </div>
</div>
<input type="hidden" id="wx_appid" value="{$appid}">
<input type="hidden" id="cert" value="">
<input type="hidden" id="certkey" value="">
<input type="hidden" id="appCertPublicKey" value="">
<input type="hidden" id="alipayCertPublicKey" value="">
<input type="hidden" id="alipayRootCert" value="">
<input type="hidden" id="tl_cert" value="">
<input type="hidden" id="tl_certkey" value="">
<input type="hidden" id="ssl" value="">
<input type="hidden" id="sslkey" value="">
<input type="hidden" id="default_ip" value="">
<input type="hidden" id="realm_ips" value="">
<input type="hidden" id="web_status" value="">
<input type="hidden" id="real_ip" value="{$real_ip}">
<input type="hidden" id="jd_sms" value="{$jd_sms}">
<input type="hidden" id="config_type" value="{$config_type}">
<input type="hidden" id="mobile_type" value="{$web_info['mobile_type']}">
<input type="hidden" id="page_index" value="">
{/block}

{block name="script"}
<script>
    require(['util'], function (util) {
        config_type = $("#config_type").val();
        $('body').on('click', '.withdrawals', function () {
            var message = $("input:checkbox[name='withdrawals']:checked").map(function (index, elem) {
                return $(elem).val();
            }).get().join(',');
            var type = $(this).val();
            var obj = $(this);
            if (message) {
                var with_type = message.split(',');
                var index = with_type.indexOf(type);
                if (index > -1) {
                    with_type.splice(index, 1);
                }
                if (type == 1) {
                    if (with_type.indexOf("4") >= 0) {
                        obj.removeAttr('checked');
                        util.message('只能选择一种银行卡提现方式', 'danger');
                    }
                }
                if (type == 4) {
                    if (with_type.indexOf("1") >= 0) {
                        obj.removeAttr('checked');
                        util.message('只能选择一种银行卡提现方式', 'danger');
                    }
                }
            }
            var config_type = $(this).data("type");
            $.ajax({
                'url': "{:__URL('PLATFORM_MAIN/config/sysConfig')}",
                'type': 'post',
                'data': {
                    'config_type': config_type
                },
                success: function (data) {
                    if (data['tl_set']['value']['tl_tw'] == 0 && type == 1) {
                        obj.removeAttr('checked');
                        util.alert('商城还没有配置银行卡，请先配置。', function () {
                            $('.payment').tab('show');
                            loading(1,'payment');
                        });
                    }
                    if (type == 2) {
                        if (data['wx_set']['is_use'] == 0 || data['wx_set']['value']['wx_tw'] == 0) {
                            obj.removeAttr('checked');
                            util.alert('商城还没有配置微信，请先配置。', function () {
                                $('.payment').tab('show');
                                loading(1,'payment');
                            });
                        }
                    }
                    if (type == 3) {
                        if (data['ali_set']['is_use'] == 0) {
                            obj.removeAttr('checked');
                            util.alert('商城还没有配置支付宝，请先配置。', function () {
                                $('.payment').tab('show');
                                loading(1,'payment');
                            });
                        }
                    }
                }
            });
        });
        // 选择链接
        $('.link_set').unbind('click').click(function () {
            var _this = $(this);
            var elm = _this.parents('.input-group-btn').parents('.item').find('input');
            util.confirm('选择页面链接','url:'+__URL(PLATFORMMAIN + '/config/modalPageLinks?t='+(new Date()).getTime()+'&platform=wap'),function(e){
              var link = this.$content.find('#selectedData').data('link')
              if(util.isEmpty(link)){
                  util.message('请选择链接')
                  return false;
              }
              
               elm.val(link);

            },'large',function(){
              this.$content.find('#portName').val('platform')
              this.$content.find('#platformName').val('h5')
            })
        });
        $('.v-nav-tabs').on('click', "li", function () {
            var config_type = $(this).children('a').data('type');
            loading(1,config_type);
        });
        util.initPage(loading(1,config_type));
        function selectConfig() {
            var type = $('body').find("input[name='type']:checked").val();
            if (type == '2') {
                $('.J-jingdong').show();
                $('.J-aliyun').hide();
            } else {
                $('.J-aliyun').show();
                $('.J-jingdong').hide();
            }
        }
        function loading(page_index,config_type) {
            if( config_type == 'change'){
                config_type = 'returnsetting';
            }
            
            $("#page_index").val(page_index);
            if(page_index == undefined){
                page_index = 1;
            }
            if ($("#config_type").val()) {
                // config_type = $("#config_type").val();
                if (config_type == 'payment') {
                    $('.payment').tab('show');
                }
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/sysConfig')}",
                async: true,
                data: {
                    "config_type": config_type,
                    "page_index" : page_index
                },
                success: function (data) {
                    if (config_type == 'basic') {
                        $("#close_reason").val(data['close_reason']);
                        if (data['reg_rule'] == 1) {
                            $("#reg_rule").prop("checked", true);
                            $(".reg_rule").show();
                        }
                        if (data['pur_rule'] == 1) {
                            $("#pur_rule").prop("checked", true);
                            $(".pur_rule").show();
                        }
                        $("#mall_name").val(data['mall_name']);
                        $("#reg_id").val(data['reg_id']);
                        $("#pur_id").val(data['pur_id']);
                        if (data['reg_id']) {
                            var htmls = '';
                            htmls += '<div class="input-group"><input type="text" class="form-control select_reg" placeholder="请选择文章"  value=" 已选择：' + data['reg_title'] + ' "  disabled>';
                            htmls += '<span class="input-group-btn"><a href="javascript:void(0);" class="btn btn-default reg_set">选择文章</a></span>';
                            htmls += '</div><p class="help-block mb-0">需前往<a class="text-primary" href="{:__URL("ADDONS_MAINquestionList")}" target="_blank">帮助中心</a>发布</p>';
                            $("#reg_message").html(htmls);
                        } else {
                            var htmls = '';
                            htmls += '<div class="input-group"><input type="text" class="form-control select_reg" placeholder="请选择文章"  value=""  disabled>';
                            htmls += '<span class="input-group-btn"><a href="javascript:void(0);" class="btn btn-default reg_set">选择文章</a></span>';
                            htmls += '</div><p class="help-block mb-0">需前往<a class="text-primary" href="{:__URL("ADDONS_MAINquestionList")}" target="_blank">帮助中心</a>发布</p>';
                            $("#reg_message").html(htmls);
                        }
                        if (data['pur_id']) {
                            var htmls = '';
                            htmls += '<div class="input-group"><input type="text" class="form-control select_pur" placeholder="请选择文章"  value=" 已选择：' + data['pur_title'] + ' "  disabled>';
                            htmls += '<span class="input-group-btn"><a href="javascript:void(0);" class="btn btn-default pur_set">选择文章</a></span>';
                            htmls += '</div><p class="help-block">需前往<a class="text-primary" href="{:__URL("ADDONS_MAINquestionList")}" target="_blank">帮助中心</a>发布</p>';
                            $("#shop_message").html(htmls);
                        } else {
                            var htmls = '';
                            htmls += '<div class="input-group"><input type="text" class="form-control select_pur" placeholder="请选择文章"  value=""  disabled>';
                            htmls += '<span class="input-group-btn"><a href="javascript:void(0);" class="btn btn-default pur_set">选择文章</a></span>';
                            htmls += '</div><p class="help-block">需前往<a class="text-primary" href="{:__URL("ADDONS_MAINquestionList")}" target="_blank">帮助中心</a>发布</p>';
                            $("#shop_message").html(htmls);
                        }
                        if (data['wap_status'] == 1) {
                            $("#waptype").prop("checked", true);
                            $('.wap_rule').show();
                        } else {
                            $('.close_rule').show();
                        }
                        if (data['wap_pop'] == 1) {
                            $("#wap_pop").prop("checked", true);
                            $(".pop_rule").show();
                        } else {
                            $(".pop_rule").hide();
                        }
                        if (data['logo']) {
                            $('#wap_logo').html('<a href="javascript:void(0);" class="close-box"><i class="icon icon-danger" title="删除"></i><img src="' + data['logo'] + '"></a>');
                        } else {
                            $('#wap_logo').html('<a href="javascript:void(0);" class="plus-box" data-toggle="singlePicture"><i class="icon icon-plus"></i></a>');
                        }
                        if (data['wap_register_adv']) {
                            $('#wap_register_adv').html('<a href="javascript:void(0);" class="close-box"><i class="icon icon-danger" title="删除"></i><img src="' + data['wap_register_adv'] + '"></a>');
                        } else {
                            $('#wap_register_adv').html('<a href="javascript:void(0);" class="plus-box" data-toggle="singlePicture"><i class="icon icon-plus"></i></a>');
                        }
                        $("#wap_register_jump").val(data['wap_register_jump']);
                        if (data['wap_login_adv']) {
                            $('#wap_login_adv').html('<a href="javascript:void(0);" class="close-box"><i class="icon icon-danger" title="删除"></i><img src="' + data['wap_login_adv'] + '"></a>');
                        } else {
                            $('#wap_login_adv').html('<a href="javascript:void(0);" class="plus-box" data-toggle="singlePicture"><i class="icon icon-plus"></i></a>');
                        }
                        $("#wap_login_jump").val(data['wap_login_jump']);
                        if (data['wap_pop_adv']) {
                            $('#wap_pop_adv').html('<a href="javascript:void(0);" class="close-box"><i class="icon icon-danger" title="删除"></i><img src="' + data['wap_pop_adv'] + '"></a>');
                        } else {
                            $('#wap_pop_adv').html('<a href="javascript:void(0);" class="plus-box" data-toggle="singlePicture"><i class="icon icon-plus"></i></a>');
                        }
                        $("#wap_pop_jump").val(data['wap_pop_jump']);
                        $("#wap_pop_rule").val(data['wap_pop_rule']);
                    }
                    if (config_type == 'message') {
                        if (!data['mobile_message']['value']['user_type']) {
                            $("input[name='type'][value='2']").prop('checked', true);
                        }

                        $("input[name='type'][value='" + data['mobile_message']['value']['user_type'] + "']").prop('checked', true);
                        selectConfig();
                        $("input[name='type']").change(function () {
                            selectConfig();
                        });
                        if (data['mobile_message']['value']['international'] == '1') {
                            $("#international").prop("checked", true);
                            $(".J-int").show();
                            if ($("input[name='type']:checked").val() == '2') {
                                $(".J-aliint").show();
                            }

                        } else {
                            $(".J-int").hide();
                            if ($("input[name='type']:checked").val() == '2') {
                                $(".J-aliint").hide();
                            }
                        }
                        $('#app_key').val(data['mobile_message']['value']['appKey']);
                        $('#secret_key').val(data['mobile_message']['value']['secretKey']);
                        $('#free_sign_name').val(data['mobile_message']['value']['freeSignName']);
                        $('#alarm_num').val(data['mobile_message']['value']['alarm_num']);
                        $('#alarm_mobile').val(data['mobile_message']['value']['alarm_mobile']);
                        $('#jd_sign_name').val(data['mobile_message']['value']['jd_sign_name']);
                        $('#int_sign_name').val(data['mobile_message']['value']['int_sign_name']);
                        $('#order_mobile').val(data['mobile_message']['value']['order_mobile']);
                        $('.J-remain_num').html(data['count']);
                        if (data['mobile_message']['is_use'] == 1) {
                            $("#mobile_is_use").prop("checked", true);
                            $('.J-sms').show();
                        } else {
                            $('.J-sms').hide();
                        }
                        if (data['email_message']['is_use'] == 1) {
                            $("#email_is_use").prop("checked", true);
                            $('#email_host').val(data['email_message']['value']['email_host']);
                            $('#email_addr').val(data['email_message']['value']['email_addr']);
                            $('#email_pass').val(data['email_message']['value']['email_pass']);
                            $('#email_id').val(data['email_message']['value']['email_id']);
                            $('.J-email').show();
                        } else {
                            $('.J-email').hide();
                        }
                        
                        html = '';
                        for (var i = 0; i < data['template_type_list'].length; i++) {
                            html += '<tr>';
                            html += '<td>' + data['template_type_list'][i]['template_name'] + '</td>';
                            if (data['template_type_list'][i]['notify_type'] == 'user') {
                                html += '<td>会员</td>';
                            } else if (data['template_type_list'][i]['notify_type'] == 'assistant') {
                                html += '<td>门店员工</td>';
                            } else {
                                html += '<td>商户</td>';
                            }
                            if (data['template_type_list'][i]['sms_type'] == 1) {
                                html += '<td>验证码</td>';
                            } else if (data['template_type_list'][i]['sms_type'] == 2) {
                                html += '<td>短信通知</td>';
                            }
                            html += '<td>';
                            html += '<div class="checkbox">';
                            if (data['template_type_list'][i]['is_sms_enable'] == 1) {
                                html += '<a href="javascript:void(0);" class="text-success message_is_open" data-is_enable="0" data-template_code="' + data['template_type_list'][i]['template_code'] + '" data-name="' + data['template_type_list'][i]['template_name'] + '" data-model="sms">已开启</a><br>';
                            } else {
                                html += '<a href="javascript:void(0);" class="text-danger message_is_open"  data-is_enable="1" data-template_code="' + data['template_type_list'][i]['template_code'] + '" data-name="' + data['template_type_list'][i]['template_name'] + '" data-model="sms">已关闭</a><br>';
                            }
                            html += '<a href="javascript:void(0);" class="text-primary vertical-top editMsg" data-type="' + data['template_type_list'][i]['notify_type'] + '" data-code="' + data['template_type_list'][i]['template_code'] + '" data-id="' + data['template_type_list'][i]['type_id'] + '">编辑模板</a>';

                            html += '</div>';
                            html += '</td>';
                            html += '<td>';
                            html += '<div class="checkbox">';
                            if (data['template_type_list'][i]['template_type'] == 'all' || data['template_type_list'][i]['template_type'] == 'email') {
                                if (data['template_type_list'][i]['is_email_enable'] == 1) {
                                    html += '<a href="javascript:void(0);" class="text-success message_is_open" data-is_enable="0" data-template_code="' + data['template_type_list'][i]['template_code'] + '" data-name="' + data['template_type_list'][i]['template_name'] + '" data-model="email">已开启</a><br>';
                                } else {
                                    html += '<a href="javascript:void(0);" class="text-danger message_is_open" data-is_enable="1" data-template_code="' + data['template_type_list'][i]['template_code'] + '" data-name="' + data['template_type_list'][i]['template_name'] + '" data-model="email">已关闭</a><br>';
                                }
                                html += '<a href="javascript:void(0);" class="text-primary vertical-top editEmail" data-type="' + data['template_type_list'][i]['notify_type'] + '" data-code="' + data['template_type_list'][i]['template_code'] + '" data-name="' + data['template_type_list'][i]['template_name'] + '" data-id="' + data['template_type_list'][i]['type_id'] + '">编辑模板</a>';
                            } else {
                                html += '--';
                            }

                            html += '</div>';
                            html += '</td>';
                            html += '</tr>';
                        }
                        $('#list').html(html);
                    }
                    if (config_type == 'payment') {
                        $('#pay-wap').removeClass('hide');
                        $('#pay-wap').addClass('show');
                        var html = '';
                        for (var i = 0; i < data['pay_list']['wap_pay_list'].length; i++) {
                            if (data['pay_list']['wap_pay_list'][i]['key'] == 'ETHPAY' && '{$blockchain}' == 0) {
                                continue;
                            }
                            if (data['pay_list']['wap_pay_list'][i]['key'] == 'EOSPAY' && '{$blockchain}' == 0) {
                                continue;
                            }
                            if (data['pay_list']['wap_pay_list'][i]['is_use'] == '1') {
                                var pay_class = 'pay-pick';
                            } else {
                                var pay_class = 'pay-nopick';
                            }
                            html += '<div class="pay-method">' +
                                    '<div class="' + pay_class + '"></div>' +
                                    '<div class="pay-img-new"><img width="120px" src="' + data['pay_list']['wap_pay_list'][i]['logo'] + '"></div>' +
                                    '</div>';
                        }
                        $('.J-h5').html(html);
                        if (data['pay_list']['is_minipro'] == '1') {
                            $('#pay-mp').removeClass('hide');
                            $('#pay-mp').addClass('show');
                            var html = '';
                            for (var i = 0; i < data['pay_list']['mp_pay_list'].length; i++) {
                                if (data['pay_list']['mp_pay_list'][i]['is_use'] == '1') {
                                    var pay_class = 'pay-pick';
                                } else {
                                    var pay_class = 'pay-nopick';
                                }
                                html += '<div class="pay-method">' +
                                        '<div class="' + pay_class + '"></div>' +
                                        '<div class="pay-img-new"><img width="120px" src="' + data['pay_list']['mp_pay_list'][i]['logo'] + '"></div>' +
                                        '</div>';
                            }
                            $('.J-mp').html(html);
                        }
                        if (data['pay_list']['is_app'] == '1') {
                            $('#pay-app').removeClass('hide');
                            $('#pay-app').addClass('show');
                            var html = '';
                            for (var i = 0; i < data['pay_list']['app_pay_list'].length; i++) {
                                if (data['pay_list']['app_pay_list'][i]['is_use'] == '1') {
                                    var pay_class = 'pay-pick';
                                } else {
                                    var pay_class = 'pay-nopick';
                                }
                                html += '<div class="pay-method">' +
                                        '<div class="' + pay_class + '"></div>' +
                                        '<div class="pay-img-new"><img width="120px" src="' + data['pay_list']['app_pay_list'][i]['logo'] + '"></div>' +
                                        '</div>';
                            }
                            $('.J-app').html(html);
                        }

                    }
                    if (config_type == 'tradeset') {
                        var has_express = data['has_express'];
                        if (has_express == 0) {
                            $(".has_express").removeAttr('checked');
                        }
                        $('#order_buy_close_time').val(data['order_buy_close_time']);
                        $("#order_auto_delivery").val(data['order_auto_delivery']);
                        $("#point_invoice_tax").val(data['point_invoice_tax']);

                        if (data['is_point'] == 1) {
                            $("#point").prop("checked", true);
                            $(".point_rule").show();
                            $("#integral_calculation").attr('required', 'required');
                            $("#shopping_back_points").attr('required', 'required');
                            $("#point_invoice_tax").attr('required', 'required');
                        } else {
                            $("#integral_calculation").removeAttr('required');
                            $("#shopping_back_points").removeAttr('required');
                            $("#point_invoice_tax").removeAttr('required');
                        }
                        if (data['is_point_deduction'] == 1) {
                            $("#point_deduction").prop("checked", true);
                            $(".point_deduction_rule").show();
                            $("#point_deduction_calculation").attr('required', 'required');
                            $("#point_deduction_max").attr('required', 'required');
                        } else {
                            $("#point_deduction_calculation").removeAttr('required');
                            $("#point_deduction_max").removeAttr('required');
                        }
                        //自动评论设置
                        if (data['is_translation'] == 1) {
                            $("#is_translation").prop("checked", true);
                            $(".translation_rule").show();
                            $("#translation_time").attr('required', 'required');
                        } else {
                            $("#translation_time").removeAttr('required', 'required');
                        }
                        $("#translation_time").val(data['translation_time']);
                        $("#translation_text").val(data['translation_text']);
                        //好评送积分
                        if (data['evaluate_give_point'] == 1) {
                            $("#evaluate_give_point").prop("checked", true);
                            $(".point_num").removeClass('hide');
                            $("#point_num").attr('required', 'required');
                        } else {
                            $(".point_num").addClass('hide');
                            $("#point_num").removeAttr('required', 'required');
                        }
                        $("#point_num").val(data['point_num']);

                        $("#point_deduction_calculation").val(data['point_deduction_calculation']);
                        $("#point_deduction_max").val(data['point_deduction_max']);
                        $("#order_delivery_complete_time").val(data['order_delivery_complete_time']);
                        $("#shopping_back_points").val(data['shopping_back_points']);
                        $("#integral_calculation").val(data['integral_calculation']);
                        $("#convert_rate").val(data['convert_rate']);

                        //余额转账设置
                        if (data['is_transfer'] == 1) {
                            //选中状态
                            $("#balance_transfer").prop("checked", true);
                            $('.balance_transfer_rule').show();
                        } else {
                            $('.balance_transfer_rule').hide();
                        }
                        if (data['is_transfer_charge'] == 1) {
                            //选中状态
                            $("#balance_transfer_charge").prop("checked", true);
                            $('.balance_transfer_charge_rule').show();
                        } else {
                            $('.balance_transfer_charge_rule').hide();
                        }
                        if (data['charge_type'] == 1) {
                            //选中状态
                            $("input[name=charge_type]:eq(0)").attr("checked", 'checked');
                            $("#charge_input").removeClass('hide');
                            $("#charge_input1").addClass('hide');
                        } else {
                            $("input[name=charge_type]:eq(1)").attr("checked", 'checked');
                            $("#charge_input").addClass('hide');
                            $("#charge_input1").removeClass('hide');
                        }
                        $("#charge_pares").val(data['charge_pares']);
                        $("#charge_pares_min").val(data['charge_pares_min']);
                        $("#CS-input-wrpcharge_pares2").val(data['charge_pares2']);
                        //美丽分设置
                        if (data['is_beautiful_point_transfer'] == 1) {
                            //选中状态
                            $("#beautiful_point_transfer").prop("checked", true);
                        }
                        //余额积分转账设置
                        if (data['is_point_transfer'] == 1) {
                            //选中状态
                            $("#point_balance_transfer").prop("checked", true);
                            $('.point_balance_transfer_rule').show();
                        } else {
                            $('.point_balance_transfer_rule').hide();
                        }
                        if (data['is_point_transfer_charge'] == 1) {
                            //选中状态
                            $("#point_balance_transfer_charge").prop("checked", true);
                            $('.point_balance_transfer_charge_rule').show();
                        } else {
                            $('.point_balance_transfer_charge_rule').hide();
                        }
                        if (data['point_charge_type'] == 1) {
                            //选中状态
                            $("input[name=point_charge_type]:eq(0)").attr("checked", 'checked');
                            $("#point_charge_input").removeClass('hide');
                            $("#point_charge_input1").addClass('hide');
                        } else {
                            $("input[name=point_charge_type]:eq(1)").attr("checked", 'checked');
                            $("#point_charge_input").addClass('hide');
                            $("#point_charge_input1").removeClass('hide');
                        }
                        $("#point_charge_pares").val(data['point_charge_pares']);
                        $("#point_charge_pares_min").val(data['point_charge_pares_min']);
                        $("#point_charge_pares2").val(data['point_charge_pares2']);
                        //支付密码开关
                        if (data['close_pay_password'] == 1) {
                            //关闭
                            $("#close_pay_password").removeAttr("checked");
                            $("#pay_password_length").addClass('hide');
                        }else{
                            $("#pay_password_length").removeClass('hide');
                            //密码长度
                            if (data['pay_password_length'] == 9) {
                                //9位
                                $("input[name=pay_password_length]:eq(0)").attr("checked", 'checked');
                            } else if(data['pay_password_length'] == 6){
                                //6位
                                $("input[name=pay_password_length]:eq(1)").attr("checked", 'checked');
                            }
                        }
                    }
                    if (config_type == 'returnsetting') {
                        var html = '';
                        if (data.data.length > 0) {
                            for (var i = 0; i < data.data.length; i++) {
                                html += '<tr>';
                                html += '<td>' + data.data[i]["consigner"] + '</td>';
                                html += '<td>' + data.data[i]["mobile"] + '</td>';
                                html += '<td>' + data.data[i]["province_name"] + data.data[i]["city_name"] + data.data[i]["dictrict_name"] + '</td>';
                                html += '<td>' + data.data[i]["address"] + '</td>';
                                html += data.data[i]["is_default"] == 1 ? '<td><span class="label label-success">是</span></td>' : '<td><span class="label label-danger">否</span></td>';
                                html += '<td class="operationLeft fs-0">';
                                html += '<a class="btn-operation" href="javascript:addressEdit(' + data.data[i]["return_id"] + ');">编辑</a>';
                                html += '<a class="btn-operation address_return_delete text-red1" href="javscript:void(0);" data-return_id="' + data.data[i]["return_id"] + '">删除</a>';
                                html += '</td>';
                                html += '</tr>';
                            }
                        } else {
                            html += '<tr><td class="h-200" colspan="6">暂无数据记录</td></tr>';
                        }
                       
                        $("#address_list").html(html);
                    }
                    if (config_type == 'withdrawalset') {
                        var withdraw_message = data['value']['withdraw_message'];
                        if(withdraw_message){
                            withdraw_message = withdraw_message.split(',');
                            for (var i = 0; i < withdraw_message.length; i++) {
                                $('[name="withdrawals"][value="' + withdraw_message[i] + '"]').prop("checked", true);
                            }
                        }
                        $('#cash_min').val(data['value']['withdraw_cash_min']);
                        $("#poundage").val(data['value']['withdraw_poundage']);
                        $("#member_poundage").val(data['value']['member_withdraw_poundage']);
                        if (data['is_use'] == 1) {
                            $("#switch").prop("checked", true);
                            $('.withdraw_rule').show();
                        }
                        if (data['value']['is_examine'] == 1) {
                            $("#is_examine").prop("checked", true);
                        }
                        if (data['value']['make_money'] == 1) {
                            $("#make_money").prop("checked", true);
                        }
                        $("#withdrawalsbegin").val(data['value']['withdrawals_begin']);
                        $("#withdrawalsend").val(data['value']['withdrawals_end']);
                    }
                    if (config_type == 'copystyle') {
                        $('#point_style').val(data['point_style']);
                        $("#balance_style").val(data['balance_style']);
                    }
                    if (config_type == 'storageconfig') {
                        if (data['type'] == 1) {
                            $("input[name='storage_type'][value='1']").prop('checked', true);
                            $('.J-alioss').hide();
                        } else if (data['type'] == 2) {
                            $("input[name='storage_type'][value='2']").prop('checked', true);
                            var html = '';
                            html += '<option value="0">请选择</option>';
                            for (var i = 0; i < data['buckets'].length; i++) {
                                html += '<option value="' + data["buckets"][i]["name"] + "@@" + data["buckets"][i]["location"] + '" ';
                                if (data["buckets"][i]["name"] == data["data"]["alioss"]["Bucket"] || data["data"]["alioss"]["Bucket"] == data["buckets"][i]["name"] + "@@" + data["buckets"][i]["location"]) {
                                    html += 'selected';
                                }
                                html += ' data-buck="' + data["buckets"][i]["location"] + '">' + data["buckets"][i]["name"] + "@@" + data["bucket_datacenter"][data['buckets'][i]["location"]] + '</option>';
                            }
                            $("#Bucket").html(html);
                            $('.J-alioss').show();
                            $('#accessKeyId').val(data['data']['alioss']['Accesskey']);
                            $("#accessKeySecret").val(data['data']['alioss']['Secretkey']);
                            $("#AliossUrl").val(data['data']['alioss']['AliossUrl']);
                        }
                    }
                    if (config_type == 'redis') {
                        $('#host').val(data['host']);
                        $("#pass").val(data['pass']);
                    }
                    if (config_type == 'wechat') {
                        $('#open_appid').val(data['open_appid']);
                        $("#open_secrect").val(data['open_secrect']);
                        $("#open_key").val(data['open_key']);
                        $("#open_token").val(data['open_token']);
                    }
                    if (config_type == 'validate') {
                        if (data['pc'] == 1) {
                            $("#switch3").prop("checked", true);
                        }
                    }
                    $('#page').paginator('option', {
                        totalCounts: data['total_count']  // 动态修改总数
                    });
                }
            });
        }
        //余额转账设置 
        $('#balance_transfer').on('click', function () {
            if ($(this).is(':checked')) {
                $('.balance_transfer_rule').show();
            } else {
                $('.balance_transfer_rule').hide();
            }
        });
        $('#balance_transfer_charge').on('click', function () {
            if ($(this).is(':checked')) {
                $('.balance_transfer_charge_rule').show();
            } else {
                $('.balance_transfer_charge_rule').hide();
            }
        });
        $('input[name=charge_type]').click(function () {
            if ($(this).is(':checked') && $("input[name='charge_type']:checked").val() == 1) {
                $("#charge_input").removeClass('hide');
                $("#charge_input1").addClass('hide');
            } else if ($(this).is(':checked') && $("input[name='charge_type']:checked").val() == 2) {
                $("#charge_input").addClass('hide');
                $("#charge_input1").removeClass('hide');
            }
        });
        //余额积分转账
        $('#point_balance_transfer').on('click', function () {
            if ($(this).is(':checked')) {
                $('.point_balance_transfer_rule').show();
            } else {
                $('.point_balance_transfer_rule').hide();
            }
        });
        $('#point_balance_transfer_charge').on('click', function () {
            if ($(this).is(':checked')) {
                $('.point_balance_transfer_charge_rule').show();
            } else {
                $('.point_balance_transfer_charge_rule').hide();
            }
        });
        $('input[name=point_charge_type]').click(function () {
            if ($(this).is(':checked') && $("input[name='point_charge_type']:checked").val() == 1) {
                $("#point_charge_input").removeClass('hide');
                $("#point_charge_input1").addClass('hide');
            } else if ($(this).is(':checked') && $("input[name='point_charge_type']:checked").val() == 2) {
                $("#point_charge_input").addClass('hide');
                $("#point_charge_input1").removeClass('hide');
            }
        });
        //自动评论
        $('#is_translation').on('click', function () {
            if ($(this).is(':checked')) {
                $('.translation_rule').show();
                $("#translation_time").attr('required', 'required');
            } else {
                $('.translation_rule').hide();
                $("#translation_time").removeAttr('required');
            }
        });
        //好评送积分
        $('#evaluate_give_point').on('click', function () {
            if ($(this).is(':checked')) {
                $('.point_num').removeClass('hide');
                $("#point_num").attr('required', 'required');
            } else {
                $('.point_num').addClass('hide');
                $("#point_num").removeAttr('required');
            }
        });
        $('#waptype').on('click', function () {
            if ($(this).is(':checked')) {
                $(this).attr('checked', false);
                //判断是否设置账号体系
                $.ajax({
                    'url': "{:__URL('PLATFORM_MAIN/system/getAccountType')}",
                    'type': 'post',
                    'data': {},
                    success: function (data) {
                        if (data.account_type === 0) {
                            util.alert('商城还没有设置会员账号体系，请先设置好账号体系再开启商城。', function () {
                                window.open("{:__URL('PLATFORM_MAIN/system/accountSystem')}");
                                util.alert('是否已设置完成？', function () {
                                    $.ajax({
                                        'url': "{:__URL('PLATFORM_MAIN/system/getAccountType')}",
                                        'type': 'post',
                                        'data': {},
                                        success: function (data) {
                                            if (data.account_type === 0) {
                                                $('#waptype').attr('checked', false);
                                            } else {
                                                $('#waptype').attr('checked', true);
                                                $('.wap_rule').show();
                                                $('.close_rule').hide();
                                            }
                                        }
                                    });
                                });
                            });
                        } else {
                            $('#waptype').attr('checked', true);
                            $('.wap_rule').show();
                            $('.close_rule').hide();
                        }
                    }
                });
            } else {
                $('.wap_rule').hide();
                $('.close_rule').show();
            }
        });
        $('#wap_pop').on('click', function () {
            if ($(this).is(':checked')) {
                $('.pop_rule').show();
            } else {
                $('.pop_rule').hide();
            }
        });
        $('#point_deduction').on('click', function () {
            if ($(this).is(':checked')) {
                $('.point_deduction_rule').show();
                $("#point_deduction_calculation").attr('required', 'required');
                $("#point_deduction_max").attr('required', 'required');
            } else {
                $('.point_deduction_rule').hide();
                $("#point_deduction_calculation").removeAttr('required');
                $("#point_deduction_max").removeAttr('required');
            }
        });
        $('#point').on('click', function () {
            if ($(this).is(':checked')) {
                $('.point_rule').show();
                $("#order_buy_close_time").attr('required', 'required');
                $("#order_auto_delivery").attr('required', 'required');
                $("#point_invoice_tax").attr('required', 'required');
                $("#integral_calculation").attr('required', 'required');
                $("#shopping_back_points").attr('required', 'required');
            } else {
                $('.point_rule').hide();
                $("#order_buy_close_time").removeAttr('required');
                $("#order_auto_delivery").removeAttr('required');
                $("#point_invoice_tax").removeAttr('required');
                $("#integral_calculation").removeAttr('required');
                $("#shopping_back_points").removeAttr('required');
            }
        });
        $('#reg_rule').on('click', function () {
            if ($(this).is(':checked')) {
                $('.reg_rule').show();
            } else {
                $('.reg_rule').hide();
            }
        });
        $('#pur_rule').on('click', function () {
            if ($(this).is(':checked')) {
                $('.pur_rule').show();
            } else {
                $('.pur_rule').hide();
            }
        });
        $('#switch').on('click', function () {
            if ($(this).is(':checked')) {
                $('.withdraw_rule').show();
            } else {
                $('.withdraw_rule').hide();
            }
        });
        $('body').on('click', '#mobile_is_use', function () {
            if ($(this).is(':checked')) {
                $('.J-sms').show();
            } else {
                $('.J-sms').hide();
            }
        });
        $('body').on('click', '#email_is_use', function () {
            if ($(this).is(':checked')) {
                $('.J-email').show();
            } else {
                $('.J-email').hide();
            }
        });
        $('body').on('click', '#bpay_is_use', function () {
            if ($(this).is(':checked')) {
                $('.J-bpay').show();
            } else {
                $('.J-bpay').hide();
            }
        });
        $('body').on('click', '.reg_set', function () {
            var url = "{:__URL('PLATFORM_MAIN/system/selectQuestionList')}";
            util.confirm('选择文章', 'url:' + url, function () {
                var data = this.$content.find('.cms_val').val();
                var id = this.$content.find('.selectCms_id').val();
                $("#reg_id").val(id);
                $(".select_reg").val('指定文章：' + data);
            });
        });
        $('body').on('click', '.pur_set', function () {
            var url = "{:__URL('PLATFORM_MAIN/system/selectQuestionList')}";
            util.confirm('选择文章', 'url:' + url, function () {
                var data = this.$content.find('.cms_val').val();
                var id = this.$content.find('.selectCms_id').val();
                $("#pur_id").val(id);
                $(".select_pur").val('指定文章：' + data);
            });
        });
        //支付密码
        if($("#close_pay_password").is(':checked')){
            $("#pay_password_length").removeClass('hide');
        }else{
            $("#pay_password_length").addClass('hide');
        }
        $('body').on('click', '#close_pay_password', function () {
            if($(this).is(':checked')){
                $("#pay_password_length").removeClass('hide');
            }else{
                $("#pay_password_length").addClass('hide');
            }
        });
        //提现设置
        util.validate($('.form-validate6'), function (form) {
            if ($('#switch').is(':checked')) {
                var is_use = 1;
            }
            if ($('#is_examine').is(':checked')) {
                var is_examine = 1;
            } else {
                var is_examine = 2;
            }
            if ($('#make_money').is(':checked')) {
                var make_moneys = 1;
            } else {
                var make_moneys = 2;
            }
            var withdrawals_begin = $("input[name='withdrawalsbegin']").val();
            var withdrawals_end = $("input[name='withdrawalsend']").val();
            var cash_min = $("#cash_min").val();
            var poundage = $("#poundage").val();
            var member_poundage = $("#member_poundage").val();
            var message = $("input:checkbox[name='withdrawals']:checked").map(function (index, elem) {
                return $(elem).val();
            }).get().join(',');
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/memberWithdrawSetting')}",
                data: {
                    'cash_min': cash_min,
                    'member_poundage': member_poundage,
                    'poundage': poundage,
                    'is_use': is_use,
                    'make_money': make_moneys,
                    'is_examine': is_examine,
                    'message': message,
                    'withdrawals_begin': withdrawals_begin,
                    'withdrawals_end': withdrawals_end
                },
                async: true,
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading(1,'withdrawalset'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });
        //商家地址设置
        var flag5 = false;
        util.validate($('.form-validate5'), function (form) {
            var return_id = $("#return_id").val();
            var consigner = $("#return_consigner").val();
            var mobile = $("#return_mobile").val();
            var province = $("#return_provinces").val();
            var city = $("#return_cities").val();
            var district = $("#return_districts").val();
            var address = $("#return_address").val();
            var zip_code = $("#return_zip_code").val();
            var is_default = $('input[name=return_is_default]:checked').val();
            if (flag5) {
                return false;
            }
            flag5 = true;
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/returnSetting')}",
                data: {
                    'return_id': return_id,
                    'consigner': consigner,
                    'mobile': mobile,
                    'province': province,
                    'city': city,
                    'district': district,
                    'address': address,
                    'zip_code': zip_code,
                    'is_default': is_default
                },
                async: true,
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', function () {
                            loading(1,'returnsetting');
                            $('#returnsetting_list').removeClass('hide');
                            $('#returnsetting_edit').addClass('hide');
                            flag5 = false;
                        });
                    } else {
                        util.message(data["message"], 'danger', function () {
                            flag5 = false;
                        });
                    }
                }
            });
        });
        //交易设置
        util.validate($('.form-validate4'), function (form) {
            var has_express = $("input:checkbox[name='has_express']:checked").val() ? $("input:checkbox[name='has_express']:checked").val() : 0;
            var order_delivery_complete_time = $('#order_delivery_complete_time').val();//订单自动完成时间
            var order_buy_close_time = $('#order_buy_close_time').val();//订单自动关闭时间
            var order_auto_delivery = $("#order_auto_delivery").val();//自动收货时间
            var shopping_back_points = $("#shopping_back_points").val();//购物返积分节点
            var point_invoice_tax = $("#point_invoice_tax").val();//购物返积分比率
            var integral_calculation = $("#integral_calculation").val();//积分计算方式
            var convert_rate = $("#convert_rate").val();//积分折扣
            var point_deduction_calculation = $("#point_deduction_calculation").val();//积分折扣计算方式
            var point_deduction_max = $("#point_deduction_max").val();//积分最大抵扣
            var close_pay_password = $("#close_pay_password").is(':checked') ? 0 : 1;//支付密码是否关闭1关闭 0开启
            if(close_pay_password == 0){
                $("#pay_password_length").removeClass('hide');
            }else{
                $("#pay_password_length").addClass('hide');
            }
            var pay_password_length = $("input[name='pay_password_length']:checked").val();

            if ($("#point").is(":checked")) {
                var is_point = 1;//开启购物返积分
            }
            if ($("#point_deduction").is(":checked")) {
                var is_point_deduction = 1;//开启积分抵扣
            } else {
                var is_point_deduction = 0;
            }
            //获取自动评论设置
            if ($("#is_translation").is(":checked")) {
                var is_translation = 1;//开启自动评论
            } else {
                var is_translation = 0;
            }
            var translation_time = $("#translation_time").val();//自动评论节点
            var translation_text = $("#translation_text").val();//自动评论节点
            //好评送积分
            if ($("#evaluate_give_point").is(":checked")) {
                var evaluate_give_point = 1;//开启好评送积分
            } else {
                var evaluate_give_point = 0;
            }
            var point_num = $("#point_num").val();//好评送积分数量
            //获取余额转账设置
            if ($("#balance_transfer").is(":checked")) {
                var is_transfer = 1;//开启余额转账
            } else {
                var is_transfer = 0;
            }
            if ($("#balance_transfer_charge").is(":checked")) {
                var is_transfer_charge = 1;//开启余额转账手续费
            } else {
                var is_transfer_charge = 0;
            }
            var charge_type = $("input[name='charge_type']:checked").val();//手续费类型
            var charge_pares = $("#charge_pares").val();//手续费比例
            var charge_pares_min = $("#charge_pares_min").val();//手续费最低
            var charge_pares2 = $("#charge_pares2").val();//手续费固定
            //获取余额积分转账设置
            if ($("#point_balance_transfer").is(":checked")) {
                var is_point_transfer = 1;//开启余额转账
            } else {
                var is_point_transfer = 0;
            }
            if ($("#beautiful_point_transfer").is(":checked")) {
                var is_beautiful_point_transfer = 1;//开启余额转账
            } else {
                var is_beautiful_point_transfer = 0;
            }
            if ($("#point_balance_transfer_charge").is(":checked")) {
                var is_point_transfer_charge = 1;//开启余额转账手续费
            } else {
                var is_point_transfer_charge = 0;
            }
            var point_charge_type = $("input[name='point_charge_type']:checked").val();//手续费类型
            var point_charge_pares = $("#point_charge_pares").val();//手续费比例
            var point_charge_pares_min = $("#point_charge_pares_min").val();//手续费最低
            var point_charge_pares2 = $("#point_charge_pares2").val();//手续费固定

            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/shopSet')}",
                data: {
                    "has_express": has_express,
                    "is_beautiful_point_transfer": is_beautiful_point_transfer,
                    "order_delivery_complete_time": order_delivery_complete_time,
                    "order_buy_close_time": order_buy_close_time,
                    "order_auto_delivery": order_auto_delivery,
                    "convert_rate": convert_rate,
                    "shopping_back_points": shopping_back_points,
                    "is_point": is_point,
                    "integral_calculation": integral_calculation,
                    "point_invoice_tax": point_invoice_tax,
                    "is_point_deduction": is_point_deduction,
                    "point_deduction_calculation": point_deduction_calculation,
                    "point_deduction_max": point_deduction_max,
                    "is_translation": is_translation,
                    "translation_time": translation_time,
                    "translation_text": translation_text,

                    "is_transfer": is_transfer,
                    "is_transfer_charge": is_transfer_charge,
                    "charge_type": charge_type,
                    "charge_pares": charge_pares,
                    "charge_pares_min": charge_pares_min,
                    "charge_pares2": charge_pares2,

                    "is_point_transfer": is_point_transfer,
                    "is_point_transfer_charge": is_point_transfer_charge,
                    "point_charge_type": point_charge_type,
                    "point_charge_pares": point_charge_pares,
                    "point_charge_pares_min": point_charge_pares_min,
                    "point_charge_pares2": point_charge_pares2,
                    "evaluate_give_point": evaluate_give_point,
                    "point_num": point_num,
                    "close_pay_password": close_pay_password,
                    "pay_password_length": pay_password_length
                },
                async: true,
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading(1,'tradeset'));
                    } else {
                        util.message(data["message"], 'danger')
                    }
                }
            });
        });
        //基本设置
        util.validate($('.form-validate1'), function (form) {
            var reg_id = $("#reg_id").val();
            var pur_id = $("#pur_id").val();
            if ($("#waptype").is(":checked")) {
                var wap_status = 1;
            } else {
                var wap_status = 0;
            }
            if ($("#wap_pop").is(":checked")) {
                var wap_pop = 1;
            }
            if ($("#reg_rule").is(":checked")) {
                var reg_rule = 1;
            }
            if ($("#pur_rule").is(":checked")) {
                var pur_rule = 1;
            }
            var wap_logo = $("#wap_logo").find('img').attr('src');
            var wap_register_adv = $("#wap_register_adv").find('img').attr('src');
            var wap_register_jump = $("#wap_register_jump").val();
            var wap_login_adv = $("#wap_login_adv").find('img').attr('src');
            var wap_login_jump = $("#wap_login_jump").val();
            var wap_pop_adv = $("#wap_pop_adv").find('img').attr('src');
            var wap_pop_jump = $("#wap_pop_jump").val();
            var wap_pop_rule = $("#wap_pop_rule").val();
            var mall_name = $("#mall_name").val();
            var close_reason = $("#close_reason").val();
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/webConfig')}",
                async: true,
                data: {
                    'mall_name': mall_name,
                    'logo': wap_logo,
                    'reg_id': reg_id,
                    'pur_id': pur_id,
                    'reg_rule': reg_rule,
                    'pur_rule': pur_rule,
                    'close_reason': close_reason,
                    'wap_status': wap_status,
                    'wap_register_adv': wap_register_adv,
                    'wap_register_jump': wap_register_jump,
                    'wap_login_adv': wap_login_adv,
                    'wap_login_jump': wap_login_jump,
                    'wap_pop': wap_pop,
                    'wap_pop_adv': wap_pop_adv,
                    'wap_pop_jump': wap_pop_jump,
                    'wap_pop_rule': wap_pop_rule
                },
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading(1,'basic'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });


        //短信配置
        $('.messageConfig').on('click', function () {
            var jd_sms = $('#jd_sms').val();
            var mobile_type = $('#mobile_type').val();
            var html = '<form class="form-horizontal padding-15" id="messageConfig">';
            html += '<div class="form-group"><label class="col-md-3 control-label">是否启用</label><div class="col-md-8"><div class="switch-inline"><input type="checkbox" id="mobile_is_use"><label for="mobile_is_use" class=""></label></div></div></div>';
            html += '<div class="J-sms" style="display:none;">';
            html += '<div class="form-group"><label class="col-md-3 control-label">短信平台</label><div class="col-md-8">';
            if (jd_sms > 0) {
                html += '<label class="radio-inline"><input type="radio" name="type" value="2">微商来短信</label>';
            }
            html += '<label class="radio-inline"><input type="radio" name="type" value="1">阿里云</label><label class="radio-inline"><input type="radio" name="type" value="3">阿里大于</label><p class="help-block mb-0">微商来短信平台充值短信即可使用，阿里云与阿里大于短信平台需要前往阿里云注册账号并购买短信业务。</p></div></div>';
            html += '<div class="J-jingdong">';
            html += '<div class="form-group"><label class="col-md-3 control-label">剩余数量</label><div class="col-md-8"><div class="input-group"><span class="J-remain_num" style="line-height:30px;color:red">0</span><span class="input-group-btn"><a href="' + __URL('PLATFORM_MAIN/Addonslist/topUpBalance') + '" target="_blank" class="btn btn-default">充值</a></span></div><p class="help-block mb-0">短信剩余可发送数量</p></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>短信签名</label><div class="col-md-8"><input type="text" class="form-control" id="jd_sign_name" maxlength="8" value=""><div class="mb-0 help-block">请输入长度2-8位的短信签名，不允许纯数字、标点符号、空格与带测试字样，一般签名使用“公司名称”、“品牌名称”、“商城名称”等</div></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>短信警报数量</label><div class="col-md-8"><input type="text" class="form-control" id="alarm_num" value="" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')"><p class="help-block">0或空则不警报</p></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>警报通知手机</label><div class="col-md-8"><input type="text" class="form-control" id="alarm_mobile" value="" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')"><p class="help-block">当短信数量到达警报数时，系统会给该手机发送一条通知短信。</p></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label">订单通知手机</label><div class="col-md-8"><input type="text" class="form-control" id="order_mobile" value="" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')"><p class="help-block">付款成功、申请售后等商家短信通知的手机。</p></div></div>';
            html += '</div>';
            html += '<div class="form-group J-aliyun J-aliint"><label class="col-md-3 control-label"><span class="text-bright">*</span>accessKeyId</label><div class="col-md-8"><input type="text" class="form-control" id="app_key" value=""></div></div>';
            html += '<div class="form-group J-aliyun J-aliint"><label class="col-md-3 control-label"><span class="text-bright">*</span>accessKeySecret</label><div class="col-md-8"><input type="text" class="form-control" id="secret_key" value=""></div></div>';
            html += '<div class="form-group J-aliyun"><label class="col-md-3 control-label"><span class="text-bright">*</span>短信签名</label><div class="col-md-8"><input type="text" class="form-control" id="free_sign_name" value="" ></div></div>';
            if (mobile_type) {
                html += '<div class="form-group"><label class="col-md-3 control-label">国际短信</label><div class="col-md-5"><div class="switch-inline"><input type="checkbox" id="international"><label for="international" class=""></label></div><p class="help-block">选择“国际手机号码”账号体系的客户需要配置国际短信，目前国际短信暂时只支持阿里云短息，下方配置为阿里云短信的配置。</p></div></div>';

                html += '<div class="form-group J-int"><label class="col-md-3 control-label"><span class="text-bright">*</span>国际短信签名</label><div class="col-md-8"><input type="text" class="form-control" id="int_sign_name" value="" ></div></div>';
            }
            html += '</div>';
            html += '</form>';
            loading(1,'message');
            util.confirm('短信配置', html, function () {
                if (this.$content.find('#mobile_is_use').is(':checked')) {
                    var is_use = 1;
                }
                var international = 0;
                if (this.$content.find('#international').is(':checked')) {
                    international = 1;
                }
                var user_type = this.$content.find("input[name='type']:checked").val();
                var app_key = this.$content.find('#app_key').val();
                var secret_key = this.$content.find('#secret_key').val();
                var free_sign_name = this.$content.find('#free_sign_name').val();
                var alarm_num = this.$content.find('#alarm_num').val();
                var alarm_mobile = this.$content.find('#alarm_mobile').val();
                var jd_sign_name = this.$content.find('#jd_sign_name').val();
                var int_sign_name = this.$content.find('#int_sign_name').val();
                var order_mobile = this.$content.find('#order_mobile').val();
                if (is_use == 1) {
                    if (user_type !== '2') {
                        if (app_key == '') {
                            util.message('请填写accessKeyId', 'danger');
                            this.$content.find('#app_key').focus();
                            return false;
                        }
                        if (secret_key == '') {
                            util.message('请填写accessKeySecret', 'danger');
                            this.$content.find('#secret_key').focus();
                            return false;
                        }
                        if (free_sign_name == '') {
                            util.message('请填写短信签名', 'danger');
                            this.$content.find('#free_sign_name').focus();
                            return false;
                        }

                        var reg1 = /^\d{1,}$/;
                        if (reg1.test(free_sign_name)) {
                            util.message('短信签名不能为纯数字', 'danger');
                            this.$content.find('#free_sign_name').focus();
                            return false;
                        }
                        var reg2 = /[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;
                        var reg3 = /[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]/;
                        if (reg2.test(free_sign_name) || reg3.test(free_sign_name) || free_sign_name.indexOf("·") >= 0) {
                            util.message('短信签名不能有标点符号', 'danger');
                            this.$content.find('#free_sign_name').focus();
                            return false;
                        }
                        if (free_sign_name.indexOf(" ") >= 0) {
                            util.message('短信签名不能有空格', 'danger');
                            this.$content.find('#free_sign_name').focus();
                            return false;
                        }
                        if (free_sign_name.length < 2 || free_sign_name.length > 12) {
                            util.message('短信签名长度为2-12位', 'danger');
                            this.$content.find('#free_sign_name').focus();
                            return false;
                        }
                        if (free_sign_name.indexOf("测试") >= 0) {
                            util.message('短信签名不能带有“测试”字样', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                    } else {
                        if (jd_sign_name == '') {
                            util.message('请填写短信签名', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        var reg4 = /^[a-zA-Z]+$/g;
                        if (reg4.test(jd_sign_name)) {
                            util.message('短信签名不能为纯英文', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        var reg1 = /^\d{1,}$/;
                        if (reg1.test(jd_sign_name)) {
                            util.message('短信签名不能为纯数字', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        var reg2 = /[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;
                        var reg3 = /[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]/;
                        if (reg2.test(jd_sign_name) || reg3.test(jd_sign_name) || jd_sign_name.indexOf("·") >= 0) {
                            util.message('短信签名不能有标点符号', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        if (jd_sign_name.indexOf(" ") >= 0) {
                            util.message('短信签名不能有空格', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        if (jd_sign_name.length < 2 || jd_sign_name.length > 12) {
                            util.message('短信签名长度为2-12位', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        if (jd_sign_name.indexOf("测试") >= 0) {
                            util.message('短信签名不能带有“测试”字样', 'danger');
                            this.$content.find('#jd_sign_name').focus();
                            return false;
                        }
                        
                        if (alarm_num == '') {
                            util.message('请填写短信警报数量', 'danger');
                            this.$content.find('#alarm_num').focus();
                            return false;
                        }
                        if (alarm_mobile == '') {
                            util.message('请填写警报通知手机', 'danger');
                            this.$content.find('#alarm_mobile').focus();
                            return false;
                        }
                        if (international == '1' && app_key == '') {
                            util.message('请填写accessKeyId', 'danger');
                            this.$content.find('#app_key').focus();
                            return false;
                        }
                        if (international == '1' && secret_key == '') {
                            util.message('请填写accessKeySecret', 'danger');
                            this.$content.find('#secret_key').focus();
                            return false;
                        }

                    }
                    if (international == '1' && int_sign_name == '') {
                        util.message('请填写国际短信签名', 'danger');
                        this.$content.find('#int_sign_name').focus();
                        return false;
                    }
                }
                $.ajax({
                    type: "post",
                    url: "{:__URL('PLATFORM_MAIN/config/setMobileMessage')}",
                    data: {
                        'is_use': is_use,
                        'app_key': app_key,
                        'secret_key': secret_key,
                        'free_sign_name': free_sign_name,
                        'user_type': user_type,
                        'alarm_num': alarm_num,
                        'alarm_mobile': alarm_mobile,
                        'jd_sign_name': jd_sign_name,
                        'international': international,
                        'int_sign_name': int_sign_name,
                        'order_mobile': order_mobile,
                    },
                    async: true,
                    success: function (data) {
                        if (data["code"] > 0) {
                            util.message(data["message"], 'success', loading(1,'message'));
                        } else {
                            util.message(data["message"], 'danger');
                        }
                    }
                });
            });
        });
        //邮箱配置
        $('.emailConfig').on('click', function () {
            var html = '<form class="form-horizontal padding-15" id="">';
            html += '<div class="form-group"><label class="col-md-3 control-label">是否启用</label><div class="col-md-8"><div class="switch-inline"><input type="checkbox" id="email_is_use" ><label for="email_is_use" class=""></label></div></div></div>';
            html += '<div class="J-email" style="display:none;">';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>发信人邮件地址</label><div class="col-md-8"><input type="text" class="form-control" id="email_addr" value=""></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>SMTP 服务器</label><div class="col-md-8"><input type="text" class="form-control" id="email_host" value=""></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>SMTP 身份验证用户名</label><div class="col-md-8"><input type="text" class="form-control" id="email_id" value=""></div></div>';
            html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>SMTP 身份验证码</label><div class="col-md-8"><input type="text" class="form-control" id="email_pass" value=""></div></div>';
            html += '</div>';
            html += '</form>';
            loading(1,'message');
            util.confirm('邮箱配置', html, function () {
                if (this.$content.find('#email_is_use').is(':checked')) {
                    var is_use = 1;
                }
                var email_host = this.$content.find('#email_host').val();
                var email_addr = this.$content.find('#email_addr').val();
                var email_pass = this.$content.find('#email_pass').val();
                var email_id = this.$content.find('#email_id').val();
                if (is_use == 1) {
                    if (email_host == '') {
                        util.message('请填写SMTP 服务器', 'danger');
                        this.$content.find('#email_host').focus();
                        return false;
                    }
                    if (email_addr == '') {
                        util.message('请填写发信人邮件地址', 'danger');
                        this.$content.find('#email_addr').focus();
                        return false;
                    }
                    if (email_pass == '') {
                        util.message('请填写SMTP 身份验证用户名', 'danger');
                        this.$content.find('#email_pass').focus();
                        return false;
                    }
                    if (email_id == '') {
                        util.message('SMTP 身份验证码', 'danger');
                        this.$content.find('#email_id').focus();
                        return false;
                    }
                }
                $.ajax({
                    type: "post",
                    url: "{:__URL('PLATFORM_MAIN/config/setEmailMessage')}",
                    data: {
                        'is_use': is_use,
                        'email_host': email_host,
                        'email_addr': email_addr,
                        'email_id': email_id,
                        'email_pass': email_pass
                    },
                    async: true,
                    success: function (data) {
                        if (data["code"] > 0) {
                            util.message(data["message"], 'success', loading(1,'message'));
                        } else {
                            util.message(data["message"], 'danger');
                        }
                    }
                });
            });
        });
        //编辑短信模板
        $('body').on('click', '.editMsg', function (event) {
            var id = $(this).data('id');
            var notify_type = $(this).data('type');
            var template_code = $(this).data('code');
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/notifySmsTemplate')}",
                data: {
                    'id': id,
                    'notify_type': notify_type,
                    'template_code': template_code
                },
                async: true,
                success: function (data) {
                    var name = data['template_name'];
                    var list = data['list'];
                    var html = '<form class="form-horizontal padding-15" id="">';
                    html += '<input type="hidden" id="notify_type" value="' + notify_type + '">';
                    html += '<input type="hidden" id="template_code" value="' + template_code + '">';
                    if (data['is_enable'] == 1) {
                        html += '<div class="form-group"><label class="col-md-3 control-label">是否启用</label><div class="col-md-8"><div class="switch-inline"><input type="checkbox" id="sms_is_enable" checked ><label for="sms_is_enable" class=""></label></div>';
                    } else {
                        html += '<div class="form-group"><label class="col-md-3 control-label">是否启用</label><div class="col-md-8"><div class="switch-inline"><input type="checkbox" id="sms_is_enable" ><label for="sms_is_enable" class=""></label></div>';
                    }
                    html += '</div></div>';
                    if (data['message'] != '2') {
                        html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>模版ID</label><div class="col-md-8"><input type="text" class="form-control" id="template_title" value="' + data['template_title'] + '" ></div></div>';
                    }
                    if (data['international'] == '1') {
                        html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>国际短信模版ID</label><div class="col-md-8"><input type="text" class="form-control" id="int_template_title" value="' + data['int_template_title'] + '" ></div></div>';
                    }
                    html += '<div class="form-group">' +
                            '<label class="col-md-3 control-label"><span class="text-bright"></span>示例</label>' +
                            '<div class="col-md-8">' +
                            '<div class="flex">' +
                            '<textarea disabled class="form-control bbrr0" rows="8" id="template_content">' + data['sample'] + '</textarea>' +
                            '<div class="variate-choice"><p>可选变量</p><div class="variate-choice-item">';
                    for (var i = 0; i < list.length; i++) {
                        html += '<a class="text-primary block variate-choice-code" href="javascript:void(0);" data-code="' + list[i]['replace_name'] + '">[' + list[i]['item_name'] + ']</a>';
                    }
                    html += '</div></div></div></div></div>';
                    html += '</form>';
                    util.confirm(name + "短信模版", html, function () {
                        if (this.$content.find('#sms_is_enable').is(':checked')) {
                            var is_enable = 1;
                        }
                        var template_code = this.$content.find('#template_code').val();
                        var notify_type = this.$content.find('#notify_type').val();
                        var template_title = this.$content.find('#template_title').val();
                        var int_template_title = this.$content.find('#int_template_title').val();
                        var notification_mode = this.$content.find('#notification_mode').val();
                        var template_content = this.$content.find('#template_content').val();
                        if (template_title == '') {
                            util.message('请填写模版ID', 'danger');
                            this.$content.find('#template_title').focus();
                            return false;
                        }
                        $.ajax({
                            type: "post",
                            url: "{:__URL('PLATFORM_MAIN/config/updateNotifyTemplate')}",
                            data: {
                                'type': 'sms',
                                'template_code': template_code,
                                'notify_type': notify_type,
                                'is_enable': is_enable,
                                'template_title': template_title,
                                'int_template_title': int_template_title,
                                'notification_mode': notification_mode,
                                'template_content': template_content
                            },
                            async: true,
                            success: function (data) {
                                if (data["code"] > 0) {
                                    util.message(data["message"], 'success', loading(1,'message'));
                                } else {
                                    util.message(data["message"], 'danger');
                                }
                            }
                        });

                    }, 'large');
                }
            });
        });
        //编辑邮箱模板
        $('body').on('click', '.editEmail', function () {
            var id = $(this).data('id');
            var notify_type = $(this).data('type');
            var template_code = $(this).data('code');
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/notifyEmailTemplate')}",
                data: {
                    'id': id,
                    'notify_type': notify_type,
                    'template_code': template_code
                },
                async: true,
                success: function (data) {
                    var name = data['template_name'];
                    var list = data['list'];
                    var html = '<form class="form-horizontal padding-15" id="">';
                    html += '<input type="hidden" id="email_notify_type" value="' + notify_type + '">';
                    html += '<input type="hidden" id="email_template_code" value="' + template_code + '">';
                    html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>标题</label><div class="col-md-8"><input type="text" class="form-control" id="email_template_title" value="' + data['template_title'] + '"></div></div>';
                    if (notify_type == 'business') {
                        html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>通知人邮箱</label><div class="col-md-8"><input type="text" class="form-control" id="email_notification_mode" value="' + data['notification_mode'] + '" ></div></div>';
                        html += '<div class="form-group"><label class="col-md-3 control-label"></label><div class="col-md-8">';
                        html += '多个邮箱之间用英文逗号“,”隔开';
                        html += '</div></div>';
                    }
                    html += '<div class="form-group"><label class="col-md-3 control-label"><span class="text-bright">*</span>内容</label>' +
                            '<div class="col-md-8">' +
                            '<div class="flex">' +
                            '<div style="width:580px;" id="email_template_content_' + id + '" data-content=' + '\'' + data['template_content'] + '\'' + '></div>' +
                            '<div class="variate-choice"><p>可选变量</p><div class="variate-choice-item">';
                    for (var i = 0; i < list.length; i++) {
                        html += '<a class="text-primary block copy variate-choice-email" href="javascript:void(0);" data-clipboard-text="' + list[i]['replace_name'] + '">' + list[i]['item_name'] + '</a>';
                    }
                    util.copy();
                    html += '</div></div>' +
                            '</div></div></div>';
                    if (data['is_enable'] == 1) {
                        html += '<div class="form-group"><label class="col-md-3 control-label">是否启用</label><div class="col-md-8"><div class="switch-inline"><input type="checkbox" id="email_is_enable" checked ><label for="email_is_enable" class=""></label></div></div></div>';
                    } else {
                        html += '<div class="form-group"><label class="col-md-3 control-label">是否启用</label><div class="col-md-8"><div class="switch-inline"><input type="checkbox" id="email_is_enable" ><label for="email_is_enable" class=""></label></div></div></div>';
                    }
                    html += '</form>';
                    util.confirm(name + "邮箱模版", html, function () {
                        if (this.$content.find('#email_is_enable').is(':checked')) {
                            var is_enable = 1;
                        }
                        var template_code = this.$content.find('#email_template_code').val();
                        var notify_type = this.$content.find('#email_notify_type').val();
                        var template_title = this.$content.find('#email_template_title').val();
                        var template_content = this.$content.find('#email_template_content_' + id).data('content');
                        var email_notification_mode = this.$content.find('#email_notification_mode').val();
                        if (template_title == '') {
                            util.message('请填写标题', 'danger');
                            this.$content.find('#email_template_title').focus();
                            return false;
                        }
                        if (template_content == '') {
                            util.message('请填写邮箱内容', 'danger');
                            this.$content.find('#email_template_content' + id).focus();
                            return false;
                        }
                        $.ajax({
                            type: "post",
                            url: "{:__URL('PLATFORM_MAIN/config/updateNotifyTemplate')}",
                            data: {
                                'type': 'email',
                                'template_code': template_code,
                                'notify_type': notify_type,
                                'is_enable': is_enable,
                                'notification_mode': email_notification_mode,
                                'template_title': template_title,
                                'template_content': template_content
                            },
                            async: true,
                            success: function (data) {
                                if (data["code"] > 0) {
                                    util.message(data["message"], 'success', loading(1,'message'));
                                } else {
                                    util.message(data["message"], 'danger');
                                }
                            }
                        });
                    }, 'xlarge', function () {
                        util.ueditor('email_template_content_' + id);
                    });
                }
            });
        });
        util.copy2('.copy8', 'call_payback_url1');
        util.copy2('.copy9', 'realm_ip_h5');
        util.copy2('.copy10', 'call_payback_url2');
        util.copy2('.copy11', 'realm_two_ip_h5');
        $('body').on('click', '.J-btnssl', function () {
            var _this = $(this);
            var sslpem = $("#ssl").val();
            var realm_ip = $("#realm_ip").val();
            var realm_two_ip = $('#realm_two_ip').val();
            var sslkeypem = $("#sslkey").val();
            var ssl = _this.parent().siblings().hasClass("ssl");
            var sslkey = _this.parent().siblings().hasClass("sslkey");
            if (!realm_ip) {
                util.message('请填写域名地址');
                $('#realm_ip').focus();
                return false;
            }
            if (ssl) {
                var path = "{:__URL('PLATFORM_MAIN/upload/uploadSsl')}" + '?ssl=' + sslpem + '&certtype=1&realm_ip=' + realm_ip + '&realm_two_ip=' + realm_two_ip;
            }
            if (sslkey) {
                var path = "{:__URL('PLATFORM_MAIN/upload/uploadSsl')}" + '?sslkey=' + sslkeypem + '&certtype=2&realm_ip=' + realm_ip + '&realm_two_ip=' + realm_two_ip;
            }
            util.attachmentUpload(path, function (file_url) {
                if (file_url.state == '1') {
                    if (file_url.certtype == '1') {
                        $(".ssl").val(file_url.filename);
                        $("#ssl").val(file_url.filesrc);
                    }
                    if (file_url.certtype == '2') {
                        $(".sslkey").val(file_url.filename);
                        $("#sslkey").val(file_url.filesrc);
                    }
                }
            });
        });
        //文案设置
        util.validate($('.form-validate10'), function (form) {
            var balance_style = $('#balance_style').val();
            if (balance_style == '') {
                balance_style = '余额';
            }
            var point_style = $("#point_style").val();
            if (point_style == '') {
                point_style = '积分';
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/styleConfig')}",
                async: true,
                data: {
                    "balance_style": balance_style,
                    "point_style": point_style
                },
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading(1,'copystyle'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });

        function getBankList() {
            $.ajax({
                type: "get",
                url: "{:__URL('PLATFORM_MAIN/config/getBankList')}",
                async: true,
                success: function (data) {
                    if (data['code'] == 1) {
                        if (data['data'].length > 0) {
                            var html = '';
                            data['data'].forEach((item, index) => {
                                html += '<div class="bankList" style="border-bottom: 1px solid #eee;padding-bottom: 5px;margin-bottom: 5px;">';
                                html += '<img src="' + item.bank_iocn + '" style="width:40px;height: 40px;">' +
                                        '<span style="margin-left: 11px;font-size: 14px;">' + item.bank_short_name + '</span>';
                                html += '</div>';
                            });
                            $("#bankList-group").append(html);
                        }
                    }
                }
            });
        }
        //银行卡列表
        $('body').on('click', '.pay_bankList', function () {
            var html = '<div class="bankList-group" id="bankList-group">';
            html += '</div>';
            getBankList();
            util.confirm('支持银行', html, function () {
            });
        });
        $('#list').on('click', '.message_is_open', function () {
            var model = $(this).data('model');
            var template_code = $(this).data('template_code');
            var name = $(this).data('name');
            if (model == 'sms') {
                var is_enable = $(this).data('is_enable');
            } else {
                var is_enable = $(this).data('is_enable');
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/updateNoticeTemplateEnable')}",
                data: {
                    'model': model, 'template_code': template_code, 'is_enable': is_enable
                },
                async: true,
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading(1,'message'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });
        //根据点击列表值修改支付方式是否启用
        $('#pay_list').on('click', '.payment_is_open', function () {
            var is_use = $(this).data('is_use');
            var id = $(this).data('id');
            var key = $(this).data('key');
            if (is_use == 1 && key == 'ETHPAY') {
                $.ajax({
                    'url': "{:__URL('PLATFORM_MAIN/system/getCoinConfig')}",
                    'type': 'post',
                    'data': {},
                    success: function (data) {
                        if (data.eth_status == 0) {
                            util.alert('商城还没有配置eth钱包，请先配置。', function () {
                                window.open("{:__URL('ADDONS_MAINblockChainBasicSetting')}");
                                util.alert('是否已配置完成？', function () {
                                    $.ajax({
                                        'url': "{:__URL('PLATFORM_MAIN/system/getCoinConfig')}",
                                        'type': 'post',
                                        'data': {},
                                        success: function (data) {
                                            if (data.eth_status == 1) {
                                                $.ajax({
                                                    type: "post",
                                                    url: "{:__URL('PLATFORM_MAIN/config/updateConfigIsuse')}",
                                                    data: {
                                                        'id': id, 'is_use': is_use
                                                    },
                                                    async: true,
                                                    success: function (data) {
                                                        if (data["code"] > 0) {
                                                            util.message(data["message"], 'success', loading(1,'payment'));
                                                        } else {
                                                            util.message(data["message"], 'danger');
                                                        }
                                                    }
                                                });
                                            } else {
                                                util.message('eth未完成配置', 'danger');
                                                return false;
                                            }
                                        }
                                    });
                                });
                            });
                        } else {
                            $.ajax({
                                type: "post",
                                url: "{:__URL('PLATFORM_MAIN/config/updateConfigIsuse')}",
                                data: {
                                    'id': id, 'is_use': is_use
                                },
                                async: true,
                                success: function (data) {
                                    if (data["code"] > 0) {
                                        util.message(data["message"], 'success', loading(1,'payment'));
                                    } else {
                                        util.message(data["message"], 'danger');
                                    }
                                }
                            });
                        }
                    }
                });
            } else if (is_use == 1 && key == 'EOSPAY') {
                $.ajax({
                    'url': "{:__URL('PLATFORM_MAIN/system/getCoinConfig')}",
                    'type': 'post',
                    'data': {},
                    success: function (data) {
                        if (data.eos_status == 0) {
                            util.alert('商城还没有配置eos钱包，请先配置。', function () {
                                window.open("{:__URL('ADDONS_MAINblockChainBasicSetting')}");
                                util.alert('是否已配置完成？', function () {
                                    $.ajax({
                                        'url': "{:__URL('PLATFORM_MAIN/system/getCoinConfig')}",
                                        'type': 'post',
                                        'data': {},
                                        success: function (data) {
                                            if (data.eos_status == 1) {
                                                $.ajax({
                                                    type: "post",
                                                    url: "{:__URL('PLATFORM_MAIN/config/updateConfigIsuse')}",
                                                    data: {
                                                        'id': id, 'is_use': is_use
                                                    },
                                                    async: true,
                                                    success: function (data) {
                                                        if (data["code"] > 0) {
                                                            util.message(data["message"], 'success', loading(1,'payment'));
                                                        } else {
                                                            util.message(data["message"], 'danger');
                                                        }
                                                    }
                                                });
                                            } else {
                                                util.message('eos未完成配置', 'danger');
                                                return false;
                                            }
                                        }
                                    });
                                });
                            });
                        } else {
                            $.ajax({
                                type: "post",
                                url: "{:__URL('PLATFORM_MAIN/config/updateConfigIsuse')}",
                                data: {
                                    'id': id, 'is_use': is_use
                                },
                                async: true,
                                success: function (data) {
                                    if (data["code"] > 0) {
                                        util.message(data["message"], 'success', loading(1,'payment'));
                                    } else {
                                        util.message(data["message"], 'danger');
                                    }
                                }
                            });
                        }
                    }
                });
            } else {
                $.ajax({
                    type: "post",
                    url: "{:__URL('PLATFORM_MAIN/config/updateConfigIsuse')}",
                    data: {
                        'id': id, 'is_use': is_use
                    },
                    async: true,
                    success: function (data) {
                        if (data["code"] > 0) {
                            util.message(data["message"], 'success', loading(1,'payment'));
                        } else {
                            util.message(data["message"], 'danger');
                        }
                    }
                });
            }
        });
        $('.J-realm_btn').click(function () {
            $(this).parents('.J-realm').next('.J-realm').show().siblings('.J-realm').hide();
        });
        $('.J-changeRealm').click(function () {
            util.alert('更改域名需要重新提交ssl文件，确定更改域名？', function () {
                $('#ssl').val('');
                $('#sslkey').val('');
                $('#realm_ip').val('');
                $('.ssl').val('请上传pem证书');
                $('.sslkey').val('请上传key证书');
                $('.J-changeRealm').parents('#realm').find('.J-realm:eq(0)').show().siblings('.J-realm').hide();
            });
        });
        $('body').on('click', '.copy', function () {
            util.copy1();
        });
        //返回地址
        $('body').on('click', '.address_return_list', function () {
            $('#returnsetting_list').removeClass('hide');
            $('#returnsetting_edit').addClass('hide');
        });
        //删除地址
        $('body').on('click', '.address_return_delete', function () {
            var return_id = $(this).data('return_id');
            util.alert('确定删除该地址？', function () {
                $.ajax({
                    type: "post",
                    url: "{:__URL('PLATFORM_MAIN/config/returnDelete')}",
                    data: {"return_id": return_id},
                    async: true,
                    success: function (data) {
                        if (data["code"] > 0) {
                            util.message(data["message"], 'success', function () {
                                loading(1,'returnsetting');
                            });
                        } else {
                            util.message(data["message"], 'danger');
                        }
                    }
                });
            });
        });
        $('body').on('click', '#international', function () {
            var user_type = $(this).parents('#messageConfig').find("input[name='type']:checked").val();

            if ($(this).is(':checked')) {
                if (user_type == '2') {
                    $('.J-aliint').show();
                }
                $('.J-int').show();
            } else {
                if (user_type == '2') {
                    $('.J-aliint').hide();
                }
                $('.J-int').hide();
            }
        });
        //点击设置支付方式跳转
        $('body').on('click', '.J-pay-setting', function () {
            var pay_type = $(this).data('pay_type');
            var pay_url = "{:__URL('PLATFORM_MAIN/config/payConfigHtml')}" + '?pay_type=' + pay_type;
            location.href = pay_url;
        });
        //设置对应的标签选中:支付方式
        var tab_type = '{$tab_type}';
        if (tab_type) {
            $('ul a[data-type=' + tab_type + ']').parent().addClass('active').siblings().removeClass('active');
            $('ul a[data-type=' + tab_type + ']').parent().click();
            $('#' + tab_type + '').addClass('in').addClass('active').siblings().removeClass('in').removeClass('active');
        }
        $("input[name='storage_type']").on('change', function () {
            var type = $("input[name='storage_type']:checked").val();
            if (type === '1') {
                $('.J-alioss').hide();
                $(".J-alioss input").removeAttr('required');
            } else {
                $('.J-alioss').show();
                $(".J-alioss input").attr('required', 'required');
            }
        });
        $('#accessKeySecret').on('change', function () {
            var Accesskey = $("#accessKeyId").val();
            var Secretkey = $("#accessKeySecret").val();
            if (!Accesskey) {
                util.message('请填写accessKeyId', 'danger');
                return false;
            }
            if (!Secretkey) {
                util.message('accessKeySecret', 'danger');
                return false;
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/system/getBuckets')}",
                async: true,
                data: {
                    "Accesskey": Accesskey,
                    'Secretkey': Secretkey
                },
                success: function (data) {
                    if (data['code'] <= 0) {
                        util.message(data['message'], 'danger');
                        return false;
                    } else {
                        var html = '<option value="">请选择</option>';
                        if (data['data'].length > 0) {
                            for (var i = 0; i < data["data"].length; i++) {
                                html += '<option value="' + data['data'][i]['name'] + '@@' + data['data'][i]['location'] + '" data-buck="' + data["data"][i]["location"] + '">' + data['data'][i]['loca_name'] + '</option>';
                            }
                            $('#Bucket').html(html);
                        }
                    }
                }
            });
        });
        /**
         * 存储设置
         */
        util.validate($('.form-validate7'), function () {
            var Accesskey = $("#accessKeyId").val();
            var Secretkey = $("#accessKeySecret").val();
            var Bucket = $("#Bucket").val();
            var AliossUrl = $("#AliossUrl").val();
            var type = $("input[name='storage_type']:checked").val();
            var location = $("#Bucket option:selected").data('buck');
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/system/setstorageconfig')}",
                async: true,
                data: {
                    "Accesskey": Accesskey,
                    'Secretkey': Secretkey,
                    "Bucket": Bucket,
                    "AliossUrl": AliossUrl,
                    "type": type,
                    "location": location
                },
                success: function (data) {
                    if (data['code'] > 0)
                    {
                        util.message(data["message"], 'success', loading('storageconfig'));
                    } else {
                        util.message(data["message"], 'danger');
                        return false;
                    }
                }
            });
        });
        //验证码设置
        $('.code_set').on('click', function () {
            if ($("#switch3").is(":checked")) {
                var pcCode = 1;
            } else {
                var pcCode = 0;
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/codeConfig')}",
                data: {
                    'pcCode': pcCode
                },
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading('validate'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });
        //redis设置
        util.validate($('.form-validate11'), function (form) {
            var host = $('#host').val();
            var pass = $("#pass").val();
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/redisConfig')}",
                async: true,
                data: {
                    "host": host,
                    "pass": pass
                },
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading('redis'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });
        //微信开放平台设置
        util.validate($('.form-validate12'), function (form) {
            var open_appid = $('#open_appid').val();
            var open_secrect = $("#open_secrect").val();
            var open_key = $("#open_key").val();
            var open_token = $("#open_token").val();
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/wechatOpenConfig')}",
                async: true,
                data: {
                    "open_appid": open_appid,
                    "open_secrect": open_secrect,
                    "open_key": open_key,
                    "open_token": open_token
                },
                success: function (data) {
                    if (data["code"] > 0) {
                        util.message(data["message"], 'success', loading('wechat'));
                    } else {
                        util.message(data["message"], 'danger');
                    }
                }
            });
        });
    });
    //编辑地址
    function addressEdit(id) {
        $("#return_id").val('0');
        $("#return_consigner").val('');
        $("#return_mobile").val('');
        $("#return_provinces").val('-1');
        $("#return_cities").val('-1');
        $("#return_districts").val('-1');
        $("#return_address").val('');
        $("#return_zip_code").val('');
        $('#pid').val('-1');
        $('#cid').val('-1');
        $('#aid').val('-1');
        $("#return_is_default").removeAttr('checked');
        $("#return_is_default2").removeAttr('checked');
        if (id > 0) {
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/config/getShopReturn')}",
                data: {"return_id": id},
                async: true,
                success: function (data) {
                    if (data) {
                        $("#return_id").val(data.return_id);
                        $("#return_consigner").val(data.consigner);
                        $("#return_mobile").val(data.mobile);
                        $("#return_provinces").val(data.province);
                        $("#return_cities").val(data.city);
                        $("#return_districts").val(data.district);
                        $("#pid").val(data.province);
                        $("#cid").val(data.city);
                        $("#aid").val(data.district);
                        $("#return_address").val(data.address);
                        $("#return_zip_code").val(data.zip_code);
                        if (data.is_default == 1) {
                            $("#return_is_default").prop('checked', 'true');
                        } else {
                            $("#return_is_default2").prop('checked', 'true');
                        }
                        getAddress();
                    }
                }
            });
        } else {
            $("#return_is_default2").prop('checked', 'true');
            getAddress();
        }
        $('#returnsetting_list').addClass('hide');
        $('#returnsetting_edit').removeClass('hide');
    }
    function getAddress() {
        var pid = 0, cid = 0, aid = 0;
        initProvince("#return_provinces");
        function initProvince(obj) {
            pid = $('#pid').val();
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/order/getProvince')}",
                dataType: "json",
                success: function (data) {
                    if (data != null && data.length > 0) {
                        var str = "";
                        for (var i = 0; i < data.length; i++) {
                            if (pid == data[i].province_id) {
                                str += '<option selected value="' + data[i].province_id + '">' + data[i].province_name + '</option>';
                            } else {
                                str += '<option value="' + data[i].province_id + '">' + data[i].province_name + '</option>';
                            }
                        }
                        $(obj).append(str);
                    }
                }
            });
        }
        getProvince();
        //选择省份弹出市区
        $('.getProvince').on('change', function () {
            var id = $('#return_provinces').val();
            if (id == -1) {
                id = pid;
            }
            cid = $('#cid').val();
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/order/getCity')}",
                dataType: "json",
                data: {
                    "province_id": id
                },
                success: function (data) {
                    if (data != null && data.length > 0) {
                        var str = "<option value='-1'>请选择市</option>";
                        for (var i = 0; i < data.length; i++) {
                            if (cid == data[i].city_id) {
                                str += '<option selected value="' + data[i].city_id + '">' + data[i].city_name + '</option>';
                            } else {
                                str += '<option  value="' + data[i].city_id + '">' + data[i].city_name + '</option>';
                            }
                        }
                        $('#return_cities').html(str);
                    }
                }
            });
        });
        function getProvince() {
            var id = $('#return_provinces').val();
            if (id == -1) {
                id = pid;
            }
            cid = $('#cid').val();
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/order/getCity')}",
                dataType: "json",
                data: {
                    "province_id": id
                },
                success: function (data) {
                    if (data != null && data.length > 0) {
                        var str = "<option value='-1'>请选择市</option>";
                        for (var i = 0; i < data.length; i++) {
                            if (cid == data[i].city_id) {
                                str += '<option selected value="' + data[i].city_id + '">' + data[i].city_name + '</option>';
                            } else {
                                str += '<option  value="' + data[i].city_id + '">' + data[i].city_name + '</option>';
                            }
                        }
                        $('#return_cities').html(str);
                    }
                }
            });
        }
        getSelCity();
        //选择市区弹出区域
        $('.getSelCity').on('change', function () {
            var id = $('#return_cities').val();
            aid = $('#aid').val();
            if (id == -1) {
                id = cid;
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/order/getDistrict')}",
                dataType: "json",
                data: {
                    "city_id": id
                },
                success: function (data) {
                    if (data != null && data.length > 0) {
                        var str = "<option value='-1'>请选择区</option>";
                        for (var i = 0; i < data.length; i++) {
                            if (aid == data[i].district_id) {
                                str += '<option selected value="' + data[i].district_id + '">' + data[i].district_name + '</option>';
                            } else {
                                str += '<option value="' + data[i].district_id + '">' + data[i].district_name + '</option>';
                            }
                        }
                        $('#return_districts').html(str);
                    }
                }
            });
        });
        function getSelCity() {
            var id = $('#return_cities').val();
            aid = $('#aid').val();
            if (id == -1) {
                id = cid;
            }
            $.ajax({
                type: "post",
                url: "{:__URL('PLATFORM_MAIN/order/getDistrict')}",
                dataType: "json",
                data: {
                    "city_id": id
                },
                success: function (data) {
                    if (data != null && data.length > 0) {
                        var str = "<option value='-1'>请选择区</option>";
                        for (var i = 0; i < data.length; i++) {
                            if (aid == data[i].district_id) {
                                str += '<option selected value="' + data[i].district_id + '">' + data[i].district_name + '</option>';
                            } else {
                                str += '<option value="' + data[i].district_id + '">' + data[i].district_name + '</option>';
                            }
                        }
                        $('#return_districts').html(str);
                    }
                }
            });
        }
    }
</script>
{/block}